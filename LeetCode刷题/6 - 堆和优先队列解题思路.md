[TOC]



ä¼˜å…ˆé˜Ÿåˆ—å¯ä»¥åœ¨`O(1)`æ—¶é—´å†…è·å–æœ€å¤§å€¼ï¼Œå¹¶ä¸”å¯ä»¥åœ¨`O(lon(n))`çš„æ—¶é—´å†…å–å‡ºæœ€å¤§å€¼ï¼ˆå–å‡ºä¹‹åéœ€è¦è°ƒæ•´ä¼˜å…ˆé˜Ÿåˆ—ï¼‰æˆ–æ’å…¥ä»»æ„å€¼ã€‚

ä¼˜å…ˆé˜Ÿåˆ—å¸¸å¸¸åˆ©ç”¨å †`heap`æ¥å®ç°ï¼Œå †æ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼æ€»å¤§äºç­‰äºå­èŠ‚ç‚¹çš„å€¼ï¼Œé€šå¸¸åˆ©ç”¨ä¸€ä¸ªæ•°ç»„è€Œä¸æ˜¯æŒ‡é’ˆæ¥å®ç°å †ï¼Œé€šå¸¸éœ€è¦æ³¨æ„çš„æ˜¯**ä¸Šæµ®æ“ä½œ**å’Œ**ä¸‹æ²‰æ“ä½œ**ã€‚

pythonå†…éƒ¨å¯ä»¥é€šè¿‡`heapq`æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡`Queue`çš„`PriorityQueue`æ¥å®ç°ï¼Œä¸è¿‡`PriorityQueue`æœ¬è´¨ä¸Šä¹Ÿæ˜¯åˆ©ç”¨`heapq`æ¥å®ç°çš„ã€‚

## åŸºç¡€çŸ¥è¯†ç³»åˆ—

#### Pythoné‡å†™å¯¹è±¡å®ç°å¤§æ ¹å †

```python
class Point:
    def __init__(self,data):
        self.loc = data
        self.dis = math.sqrt(data[0]**2+data[1]**2)
    
    def __gt__(self,other):
        return self.dis < other.dis # è¿™é‡Œéœ€è¦æ³¨æ„ã€‚å†™çš„æ˜¯å°äºå·

```



## TopKç³»åˆ—

#### å‰‘æŒ‡ Offer 40. æœ€å°çš„kä¸ªæ•°

æ€è·¯ï¼šåˆ©ç”¨æœ€å°å †å®ç°è§£å†³æ–¹æ¡ˆã€‚



#### 373. æŸ¥æ‰¾å’Œæœ€å°çš„Kå¯¹æ•°å­— ğŸ‰

>   ![image-20211015125614994](images/image-20211015125614994.png)
>
>   æ€è·¯ï¼šåˆ©ç”¨æœ€å°å †åŠ å“ˆå¸Œè¡¨ã€‚

```python
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        m = len(nums1)
        n = len(nums2)
        i,j = 0,0
        H = [(nums1[i]+nums2[j],i,j)]
        heapify(H)
        K = k
        ans = []
        ans_set = set()
        while H:
            print(H[0],H)
            num,p_i,p_j = heappop(H)
            ans.append([nums1[p_i],nums2[p_j]])
            K -= 1
            if K == 0:  break
            if p_i+1 < m and p_j+1 < n: 
                if (p_i+1,p_j) not in ans_set:
                    ans_set.add((p_i+1,p_j))
                    heappush(H,(nums1[p_i+1]+nums2[p_j],p_i+1,p_j))
                if (p_i,p_j+1) not in ans_set:
                    ans_set.add((p_i,p_j+1))
                    heappush(H,(nums1[p_i]+nums2[p_j+1],p_i,p_j+1))
            elif p_i+1 < m:
                if (p_i+1,p_j) not in ans_set:
                    ans_set.add((p_i+1,p_j))
                    heappush(H,(nums1[p_i+1]+nums2[p_j],p_i+1,p_j))
            elif p_j+1 < n:
                if (p_i,p_j+1) not in ans_set:
                    ans_set.add((p_i,p_j+1))
                    heappush(H,(nums1[p_i]+nums2[p_j+1],p_i,p_j+1))
            else:
                break
        return ans
```



#### 378. æœ‰åºçŸ©é˜µä¸­ç¬¬ K å°çš„å…ƒç´ 

>   ![image-20211015145954251](images/image-20211015145954251.png)
>
>   æ€è·¯ï¼š
>
>   +   $(1)$ åŒ373é¢˜ï¼Œåˆ©ç”¨æœ€å°å †åŠ å“ˆå¸Œè¡¨
>
>   +   $(2)$ åˆ©ç”¨å€¼åŸŸä¸Šçš„äºŒåˆ†æ³•

```python
class Solution:
    def kthSmallest(self, matrix: List[List[int]], k: int) -> int:
        n = len(matrix)
        H = [(matrix[0][0],0,0)]
        heapify(H)
        ans = None
        ans_set = set()
        K = k
        while H:
            num,p_i,p_j = heappop(H)
            ans = num
            K -= 1
            if K == 0:
                break            
            if (p_i + 1 < n) and (p_j + 1 < n):
                if (p_i+1,p_j) not in ans_set:
                    ans_set.add((p_i+1,p_j))
                    heappush(H,(matrix[p_i+1][p_j],p_i+1,p_j))
                if (p_i,p_j+1) not in ans_set:
                    ans_set.add((p_i,p_j+1))
                    heappush(H,(matrix[p_i][p_j+1],p_i,p_j+1))
            elif p_i + 1 < n:
                if (p_i+1,p_j) not in ans_set:
                    ans_set.add((p_i+1,p_j))
                    heappush(H,(matrix[p_i+1][p_j],p_i+1,p_j))
            elif p_j + 1 < n:
                if (p_i,p_j+1) not in ans_set:
                    ans_set.add((p_i,p_j+1))
                    heappush(H,(matrix[p_i][p_j+1],p_i,p_j+1))
            else:
                break
        return ans
```



#### 703. æ•°æ®æµä¸­çš„ç¬¬ K å¤§å…ƒç´ 

>   ![image-20211015150225212](images/image-20211015150225212.png)
>
>   æ€è·¯ï¼šåˆ©ç”¨æœ€å°å †ã€‚



#### 692. å‰Kä¸ªé«˜é¢‘å•è¯

>   ![image-20211015153610611](images/image-20211015153610611.png)
>
>   æ€è·¯ï¼šå’Œå‰kä¸ªé«˜é¢‘å­—ç¬¦ç±»ä¼¼ï¼Œä½†æ˜¯è¿™ä¸€é¢˜è¿˜éœ€è¦æ¯”è¾ƒå•è¯ä¸å•è¯ä¹‹é—´çš„å…³ç³»ï¼ŒåŒæ—¶åœ¨è¾“å‡ºçš„æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹å †è¿›è¡Œåå‘è¾“å‡º



## è´ªå¿ƒ + ä¼˜å…ˆé˜Ÿåˆ—ç³»åˆ—

#### 264. ä¸‘æ•° II

æ€è·¯ï¼šä¸‘æ•°çš„å®šä¹‰æ˜¯ä¸€ä¸ªæ•°å¯ä»¥è¢«2ï¼Œ3ï¼Œ5ä¸­çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¹˜ç§¯ç»„æˆï¼Œé™¤æ­¤ä¹‹å¤–1ä¹Ÿæ˜¯ä¸‘æ•°ã€‚ä»»ä½•ä¸€ä¸ªä¸‘æ•°ï¼Œä¹˜ä¸Š`2,3,5`éƒ½ä¼šæ˜¯ä¸‘æ•°ï¼Œå¼€å§‹æƒ…å†µä¸‹ï¼š`{1,2,3,5}`éƒ½æ˜¯ä¸‘æ•°ï¼Œé‚£ä¹ˆ`{2*2,2*3,2*5}`æ˜¯ä¸‘æ•°ï¼Œä¸€ä¸ªæ˜¯ä¿è¯ä¹˜ç§¯çš„ç¬¬ä¸€ä¸ªæ•°æ˜¯æœ€å°çš„ï¼Œç¬¬äºŒä¸ªæ˜¯é¿å…é‡å¤ã€‚ç¬¬ä¸€ä¸ªåˆ©ç”¨æœ€å°å †æ¥å®ç°ï¼Œç¬¬äºŒä¸ªé‡Œåˆ©ç”¨ifåˆ¤æ–­è¯­å¥å®ç°ã€‚

```python
# å †çš„æ•°æ®ç»“æ„ï¼š[(2,2),(3,3)]ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæ•°åªä¼šå’Œæ¯”ä»–ç­‰çº§å¤§æˆ–è€…ç›¸ç­‰çš„å…ƒç´ ç›¸ä¹˜ï¼Œæ¯”å¦‚ä¼šæœ‰2*3ï¼Œä½†ä¸ä¼šæœ‰3*2.
H = [(2,2),(3,3),(5,5)]
heapify(H)
for i in range(n-1):
    num,p = heappop(H)
    heappush(H,(num*2,2))
    if p >= 3:
	    heappush(H,(num*3,3))
        if p >= 5:
            heappush(H,(num*5,5))
return num
```

#### 502. IPO

>   ![image-20211015153722383](images/image-20211015153722383.png)
>
>   æ€è·¯ï¼šæ’åº+å¤§æ ¹å †



####  871. æœ€ä½åŠ æ²¹æ¬¡æ•°

>   ![image-20211015155649006](images/image-20211015155649006.png)
>
>   æ€è·¯ï¼šä¼˜å…ˆé˜Ÿåˆ—+è´ªå¿ƒ

```python
class Solution:
    def minRefuelStops(self, target: int, startFuel: int, stations: List[List[int]]) -> int:
        W = startFuel # è¡¨ç¤ºå½“å‰æ‹¥æœ‰çš„æ²¹é‡
        count = 0
        H = []
        heapify(H)
        idx = 0        
        while W < target:
            while idx < len(stations) and W >= stations[idx][0]:
                heappush(H,-stations[idx][1])
                idx += 1
            if not H: return -1
            else:
                count += 1
                W += -heappop(H)        
        return count
```



#### 1642. å¯ä»¥åˆ°è¾¾çš„æœ€è¿œå»ºç­‘ `å †+è´ªå¿ƒ`

>   ![image-20211015155729007](images/image-20211015155729007.png)
>
>   æ€è·¯ï¼šä¼˜å…ˆé˜Ÿåˆ—+è´ªå¿ƒï¼Œä¼˜å…ˆä½¿ç”¨æ¢¯å­ï¼Œå¦‚æœæ¢¯å­ç”¨å®Œäº†ï¼Œé‚£ä¹ˆå°±ä»çˆ¬è¿‡çš„æ¥¼æˆ¿é‡Œé¢æ‰¾å‡ºé«˜åº¦æœ€å°çš„ï¼Œç”¨ç –å—ï¼Œå¦‚æœç –å—ä¹Ÿç”¨å®Œäº†ï¼Œåˆ™è¿”å›ã€‚

```python
class Solution:
    def furthestBuilding(self, heights: List[int], bricks: int, ladders: int) -> int:
        H = []
        heapify(H)
        total_bricks = 0
        for i in range(1,len(heights)):
            diff = heights[i] - heights[i-1]
            if diff > 0:
                heappush(H,diff)
                if len(H) > ladders:
                    total_bricks += heappop(H)
                if total_bricks > bricks:
                    return i - 1
        return len(heights)-1
```



#### 253. ä¼šè®®å®¤ II

```markdow
ç»™ä½ ä¸€ä¸ªä¼šè®®æ—¶é—´å®‰æ’çš„æ•°ç»„ intervals ï¼Œæ¯ä¸ªä¼šè®®æ—¶é—´éƒ½ä¼šåŒ…æ‹¬å¼€å§‹å’Œç»“æŸçš„æ—¶é—´ intervals[i] = [starti, endi] ï¼Œä¸ºé¿å…ä¼šè®®å†²çªï¼ŒåŒæ—¶è¦è€ƒè™‘å……åˆ†åˆ©ç”¨ä¼šè®®å®¤èµ„æºï¼Œè¯·ä½ è®¡ç®—è‡³å°‘éœ€è¦å¤šå°‘é—´ä¼šè®®å®¤ï¼Œæ‰èƒ½æ»¡è¶³è¿™äº›ä¼šè®®å®‰æ’ã€‚

è¾“å…¥ï¼šintervals = [[0,30],[5,10],[15,20]]
è¾“å‡ºï¼š2
```

æ€è·¯ï¼šå †ï¼Œå †ä¸­å­˜æ”¾å½“å‰éœ€è¦å®‰æ’çš„ä¼šè®®å®¤çš„ç»“æŸæ—¶é—´

```python
class Solution:
    def minMeetingRooms(self, intervals: List[List[int]]) -> int:
        intervals.sort()
        rooms = []
        heapify(rooms)

        # åˆå§‹åŒ–ï¼Œå°†ç¬¬ä¸€ä¸ªä¼šè®®æ—¶é—´æ®µåŠ å…¥
        heappush(rooms,intervals[0][1])
        for i in range(1,len(intervals)):
            if rooms[0] <= intervals[i][0]:
                # å¦‚æœå †ä¸­ä¼šè®®çš„æœ€å°ç»“æŸæ—¶é—´æ˜¯å°äºä¸‹ä¸€åœºä¼šè®®çš„å¼€å§‹æ—¶é—´
                # é‚£ä¹ˆæ›¿æ¢æ‰å½“å‰æœ€å°ä¼šè®®
                heapreplace(rooms,intervals[i][1])
            else:
                # å¦‚æœå †ä¸­ä¼šè®®çš„æœ€å°ç»“æŸæ—¶é—´æ˜¯å¤§äºä¸‹ä¸€åœºä¼šè®®çš„å¼€å§‹æ—¶é—´
                # é‚£ä¹ˆåŠ å…¥å½“å‰ä¼šè®®
                heappush(rooms,intervals[i][1])
        return len(rooms)
```





#### 407. æ¥é›¨æ°´ II

>   ![image-20211015162139702](images/image-20211015162139702.png)
>
>   æ€è·¯ï¼šåˆ©ç”¨æœ€å°å †åŠ ä¸ŠBFSçš„æ€æƒ³è¿›è¡Œæœç´¢ã€‚è¿™ä¸€é¢˜çš„æ€è·¯å®é™…ä¸Šå’Œ`42. æ¥é›¨æ°´`æ€æƒ³ç±»ä¼¼ï¼Œéƒ½æ˜¯è®²æœ€å¤–å±‚çœ‹æˆæ˜¯å›´æ ï¼Œç„¶åä»å›´æ å°çš„åœ°æ–¹è¿›è¡Œçªç ´ã€‚

```python
class Solution:
    def trapRainWater(self, heightMap: List[List[int]]) -> int:
        m,n = len(heightMap),len(heightMap[0])
        hp = []
        visited = [[False]*n for _ in range(m)]
        # æœ€å¤–å›´æœ€å°å †
        for i in range(m):
            for j in range(n):
                if i == 0 or j == 0 or i == m-1 or j == n-1:
                    heapq.heappush(hp,(heightMap[i][j],i,j))
                    visited[i][j] = True
        
        ans = 0
        directions = [[0,1],[0,-1],[1,0],[-1,0]]
        while hp:
            h,i,j = heapq.heappop(hp)
            for direction in directions:
                x = i + direction[0]
                y = j + direction[1]
                if x >= 0 and x < m and y >= 0 and y < n and not visited[x][y]:
                    if h > heightMap[x][y]: # å›´æ æ¯”å†…éƒ¨é«˜
                        ans += (h-heightMap[x][y])
                    visited[x][y] = True
                    heapq.heappush(hp,(max(h,heightMap[x][y]),x,y))
        return ans

```





## API è®¾è®¡ç³»åˆ—



#### 295. æ•°æ®æµçš„ä¸­ä½æ•°  `Hard`

æ€è·¯ï¼šä¸­ä½æ•°çš„å¯»æ‰¾ï¼ŒåŸºæœ¬çš„æ€è·¯å¯ä»¥æ˜¯å†æ¯æ¬¡æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼Œåˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾ï¼Œä¿è¯æ’å…¥æ•°æ®çš„é¡ºåºæ€§ã€‚ä½†æ˜¯å†å¯»æ‰¾ä¸­ä½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦ä¿è¯æ•°æ®å®Œå…¨æœ‰åºã€‚å› æ­¤å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå¤§æ ¹å †å’Œå°æ ¹å †ï¼šå°æ ¹å †é‡Œé¢å­˜æ”¾è¾ƒå¤§çš„æ•°ï¼Œå¤§æ ¹å †å­˜æ”¾è¾ƒå°çš„æ•°ã€‚åŒæ—¶ä¸ºäº†ç»´æŠ¤æ•°æ®çš„åˆ†å‰²æ€§å’Œå¹³è¡¡æ€§ï¼Œæ ¹æ®æ•°æ®çš„å¥‡å¶æ€§ï¼Œè¿›è¡Œæ•°æ®çš„è°ƒæ•´ã€‚

```python
class HeapMiddle:
    def __init__(self):
        self.min_heap = []
        self.max_heap = []
    
    def addNum(self,x):
        # å½“å‰æ•°æ®æ•°é‡å¥‡å¶
        # 1. å¥‡æ•°ï¼Œè¯´æ˜å°æ ¹å †æ•°é‡è¾ƒå¤šï¼Œå› æ­¤å…ˆå°†æ•°æ®æ·»åŠ åˆ°å°æ ¹å †ä¸­ï¼Œç„¶åå°†å°æ ¹å †çš„å †é¡¶å¼¹å‡ºï¼Œå¹¶åŠ å…¥åˆ°å¤§æ ¹å †ä¸­
        # 2. å¶æ•°ï¼Œè¯´æ˜å¤§å°æ ¹å †æ•°é‡ä¸€æ ·ï¼Œå› æ­¤å…ˆå°†æ•°æ®æ·»åŠ åˆ°å¤§æ ¹å †ä¸­ï¼Œç„¶åå°†å¤§æ ¹å †çš„å †é¡¶å¼¹å‡ºï¼Œå¹¶åŠ å…¥åˆ°å°æ ¹å †ä¸­
        if len(self.min_heap) == len(self.max_heap):
            heapq.heappush(self.max_heap,-num)
            heapq.heappush(self.min_heap,-heapq.heappop(self.max_heap))
        else:
            heapq.heappush(self.min_heap,num)
            heapq.heappush(self.max_heap,-heapq.heappop(self.min_heap))
    
    def getMiddle(self):
        # å½“å‰æ•°æ®æ•°é‡å¥‡å¶
        # 1. å¥‡æ•°ï¼Œè¿”å›å°æ ¹å †å †é¡¶è®¡ç®—ä¸­ä½æ•°
        # 2. å¶æ•°ï¼Œåˆ©ç”¨å¤§æ ¹å †å’Œå°æ ¹å †å †é¡¶è®¡ç®—ä¸­ä½æ•°
        if len(self.min_heap) == len(self.max_heap):
            return (-self.max_heap[0] + self.min_heap[0]) / 2
        else:
            return self.min_heap[0]
```



![image.png](../\LeetCodeåˆ·é¢˜\images\1612362061-eqjoaI-image.png)



#### å‰‘æŒ‡ Offer 59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼

>   ![image-20211015162731075](images/image-20211015162731075.png)
>
>   æ€è·¯ï¼šç»´æŠ¤ä¸€ä¸ª`å•è°ƒé€’å‡`é˜Ÿåˆ—ï¼Œæˆ‘ä»¬åªéœ€è®°ä½å½“å‰æœ€å¤§å€¼å‡ºé˜Ÿåï¼Œé˜Ÿåˆ—é‡Œçš„ä¸‹ä¸€ä¸ªæœ€å¤§å€¼å³å¯ã€‚

```python
class MaxQueue:

    def __init__(self):
        self.queue = collections.deque([])
        self.aux_queue = collections.deque([])

    def max_value(self) -> int:
        if not self.queue: return -1
        return self.aux_queue[0]

    def push_back(self, value: int) -> None:
        self.queue.append(value)
        while self.aux_queue and self.aux_queue[-1] < value:
            self.aux_queue.pop()
        self.aux_queue.append(value)

    def pop_front(self) -> int:
        if not self.queue: return -1
        val = self.queue.popleft()
        if self.aux_queue[0] == val:
            self.aux_queue.popleft()
        return val
        
# Your MaxQueue object will be instantiated and called as such:
# obj = MaxQueue()
# param_1 = obj.max_value()
# obj.push_back(value)
# param_3 = obj.pop_front()
```





## å»¶è¿Ÿåˆ é™¤ç³»åˆ—

#### 387. å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå”¯ä¸€å­—ç¬¦ ğŸ‰

>   ![image-20210917155512815](images/image-20210917155512815.png) [4 - æ•°å­¦è¿ç®—.md](4 - æ•°å­¦è¿ç®—.md) 
>
>   åˆ©ç”¨é˜Ÿåˆ—å’Œå“ˆå¸Œè¡¨è¯•ä¸‹å»¶è¿Ÿåˆ é™¤åŠŸèƒ½ã€‚
>
>   ![image-20210917155617317](images/image-20210917155617317.png)

```python
class Solution:
    def firstUniqChar(self, s: str) -> int:
        visited = [0]*26
        queue = collections.deque([])
        n = len(s)

        for i in range(n):
            c = s[i]
            if visited[ord(c)-97] == 0:
                visited[ord(c)-97] = 1
                queue.append((i,c))
            else:
                visited[ord(c)-97] = -1
                while queue and visited[ord(queue[0][1])-97] == -1:
                    queue.popleft()
            
        return -1 if not queue else queue[0][0]
```

