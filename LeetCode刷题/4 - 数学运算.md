[TOC]



## 1. ä½è¿ç®—ç›¸å…³  [ğŸ”—](https://oi-wiki.org/math/bit/)

#### ä½è¿ç®—æŠ€å·§

+ n&(n-1)çš„ä½œç”¨

`n&(n-1)`çš„ä½œç”¨åœ¨äºå»é™¤nçš„äºŒè¿›åˆ¶ä¸²ä¸­æœ€åä¸€ä¸ª1ã€‚

![image-20210512153803121](images/image-20210512153803121.png)

+   n&1çš„ä½œç”¨

`n&1`çš„ä½œç”¨åœ¨äºæ‰¾åˆ°åˆ¤æ–­æœ€åä¸€ä½æ˜¯å¦ä¸º0ã€‚

+   åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯2çš„éè´Ÿæ•´æ•°æ¬¡å¹‚

```python
judge = lambda n: n>0 and n&(n-1)==0
```

+   è·å–äºŒè¿›åˆ¶çš„æŸä¸€ä½ï¼Œä¸‹æ ‡ä»0å¼€å§‹

```python
get_bit = lambda a,b: (a >> b) & 1
```

+   æ“ä½œäºŒè¿›åˆ¶çš„æŸä¸€ä½ï¼Œä¸‹æ ‡ä»0å¼€å§‹

```python
set_bit_0 = lambda a,b: a & ~(1<<b) # å°†ä½ç¬¬bä½è®¾ç½®ä¸º0
set_bit_1 = lambda a,b: a | (1<<b) # å°†ä½ç¬¬bä½è®¾ç½®ä¸º1
set_bit_2 = lambda a,b: a ^ (1<<b) # å°†ä½ç¬¬bä½å–å
```

+   å–å‡ºæœ€å³è¾¹çš„1ï¼Œæ‰€ä»£è¡¨çš„æ•°

    ```python
    get_lower_bit = lambda data:data&(-data)
    # æ¯”å¦‚ n=0b100[10]
    # å¾—åˆ° n&(-n)=0b10
    ```

+   åŸç ã€åç å’Œè¡¥ç  [ğŸ”—](https://zhuanlan.zhihu.com/p/99082236)

    åŸç ï¼šæœ€é«˜ä½è¡¨ç¤ºç¬¦å·ä½ï¼Œå…¶ä»–ä½å­˜æ”¾è¯¥æ•°äºŒè¿›åˆ¶çš„ç»å¯¹å€¼ã€‚ä¼šå‡ºç°$+0$å’Œ$-0$ çš„æƒ…å†µï¼Œæ— æ³•ç›´æ¥åŠ å‡è¿ç®—ã€‚
    
    åç ï¼šæ­£æ•°çš„åç ç­‰äºåŸç ï¼›è´Ÿæ•°ï¼Œç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™ä½æ±‚åã€‚ä¼šå‡ºç°$+0(0000)$å’Œ$-0(1000)$ çš„æƒ…å†µï¼Œæ— æ³•ç›´æ¥åŠ å‡è¿ç®—ã€‚
    
    è¡¥ç ï¼šæ­£æ•°çš„è¡¥ç ç­‰äºåŸç ï¼›è´Ÿæ•°ï¼Œè¡¥ç ç­‰äºåç  $+1$ã€‚
    
    pythonçš„`bin`å‡½æ•°çš„è´Ÿæ•°è¾“å‡ºï¼š`-` + `åŸç `
    
    pythonä¸­è·å–è´Ÿæ•°32ä½è¡¥ç çš„æ–¹å¼ï¼š`b = a&0xffffffff`
    
    pythonä»32è¡¥ç è·å–åŸæ•°çš„æ–¹å¼ï¼š`a=~(b^0xffffffff)`
    
    pythonåœ¨32ä½è¡¥ç çš„è´Ÿæ•°çš„æ— ç¬¦å·è¡¨ç¤ºå‡å¤§äºï¼š$a>0x7fffffff$ï¼Œå› ä¸ºè´Ÿæ•°è¡¥ç ç¬¦å·ä½å‡ä¸º $1$ ã€‚



#### å¼‚æˆ–è¿ç®—æ€§è´¨

+   $x\oplus x = 0$
+   $x\oplus y = y \oplus x$
+   $(x\oplus y)\oplus z=x\oplus (y\oplus z)$
+   $x\oplus y \oplus y = x$
+   $(x\& y)\oplus (x\& z) = x \&(y\oplus z)$
+   $(x+a)\oplus(y+b)=x\oplus y+x\oplus b + y \oplus a + a \oplus b$
+   $4i\oplus (4i+1) \oplus (4i+2) \oplus (4i+3)=0$



#### å¿«é€Ÿå¹‚è®¡ç®—

```python
def fast(x,n):
    ans = 1
    while n > 0:
        if n&1 == 1: ans *= x
        x *= x
        n >>= 1
    return ans 
```



####  é¢è¯•é¢˜ 01.01. åˆ¤å®šå­—ç¬¦æ˜¯å¦å”¯ä¸€

```python
# å‰æä¸€å®šæ˜¯æ‰€æœ‰çš„å­—ç¬¦æ˜¯å°å†™å­—æ¯ï¼Œå¦è€…çš„è¯ç”¨é›†åˆåˆ¤é‡
class Solution:
    def isUnique(self, astr: str) -> bool:
        mask = 0

        for c in astr:
            move_bits = ord(c) - ord('a')
            if (mask & (1 << move_bits)) != 0:
                return False
            else:
                mask = mask | (1 << move_bits)
        return True
```

#### é¢è¯•é¢˜ 16.01. äº¤æ¢æ•°å­— 

æ€è·¯ï¼šè¿™ä¸€é¢˜åˆ©ç”¨çš„æ˜¯`å¼‚æˆ–`çš„ä¸€ä¸ªæ€§è´¨ï¼š`A^B^A=B`ã€‚

```python
å‡è®¾å­˜åœ¨ä¸¤ä¸ªæ•°å­—ï¼šA B,é€šè¿‡å¼‚æˆ–å¯ä»¥å®ç°ä¸ç”¨ä¸­é—´å˜é‡å®Œæˆå…ƒç´ çš„äº¤æ¢ã€‚
0             1
A             B
A^B           B
A^B           B^A^B=A
A^B^A         A
B             A

def swap(A,B):
    A ^= B
    B ^= A
    A ^= B
    return A,B
```



#### å‰‘æŒ‡ Offer 56 - I æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•° I

>   ![image-20211015170301863](images/image-20211015170301863.png)
>
>   æ€è·¯ï¼šå°†æ‰€æœ‰æ•°æ®è¿›è¡Œå¼‚æˆ–ä¹‹åï¼›å–å‡ºæœ€ä½ä½çš„1æ‰€ä»£è¡¨çš„æ•°ï¼›ç„¶åéå†æ•°ç»„ï¼Œå’Œåˆšæ‰çš„æ•°è¿›è¡Œ&è¿ç®—ï¼Œåˆ†åˆ«å¾—åˆ°ä¸¤ç§æƒ…å†µä¸‹çš„ç»“æœã€‚

```python
class Solution {
    public int[] singleNumbers(int[] nums) {
        int xor_res = 0;
        for(int num:nums) {
            xor_res ^= num;
        }
        int diff = xor_res&(-xor_res);
        int x=0,y=0;
        for(int num:nums) {
            if((num&diff) == 0) {
                x^=num;
            } else{
                y^=num;
            }
        }
        return new int[]{x,y};
    }
}
```



#### å‰‘æŒ‡ Offer 56 - II. æ•°ç»„ä¸­æ•°å­—å‡ºç°çš„æ¬¡æ•° II

>   
>
>   ![image-20210720150845459](images/image-20210720150845459-1626764927275.png)

æ€è·¯ï¼šçœŸå€¼è¡¨

|  n   | two  | one  | two  | one  |
| :--: | :--: | :--: | :--: | :--: |
|  0   |  0   |  0   |  0   |  0   |
|  0   |  0   |  1   |  0   |  1   |
|  0   |  1   |  0   |  1   |  0   |
|  1   |  0   |  0   |  0   |  1   |
|  1   |  0   |  1   |  1   |  0   |
|  1   |  1   |  0   |  0   |  0   |

å¾—åˆ°è§„å¾‹ï¼š

```markdown
if two == 0:
    if n == 0:
        one = one
    elif n == 1:
        one = ~one
elif two == 1:
    one = 0

# -->
if two == 0:
    one = one^n
else:
    one = 0

# -->    
one= one ^ n & ~two

# åŒç†ï¼ŒåŸºäºæ–°oneï¼Œå¾—åˆ°two
two = two ^ n & ~one
```

```python
class Solution:
    def singleNumber(self, nums: List[int]) -> int:
        one,two = 0,0
        for n in nums:
            one = one^n&~two
            two = two^n&~one
        return one
    
# or
class Solution:
    def singleNumber(self, nums: List[int]) -> int:
        get_digit = lambda n,i: (n>>(i-1))&1
        digits = [0]*32

        for num in nums:
            for i in range(32):
                digits[31-i] += get_digit(num,i+1)
        
        for i in range(32):
            digits[i]  = str(digits[i] % 3) 
        
        return int("".join(digits),2)
```



#### å‰‘æŒ‡ Offer 65. ä¸ç”¨åŠ å‡ä¹˜é™¤åšåŠ æ³• ğŸ‰

>   æ€è·¯ï¼šè½¬æ¢æˆäºŒè¿›åˆ¶åŠ æ³•ï¼ŒçœŸå€¼è¡¨ï¼š
>
>   <img src="images/56d56524d8d2b1318f78e209fffe0e266f97631178f6bfd627db85fcd2503205-Picture1.png" alt="Picture1.png" style="zoom: 50%;" />

```python
"""
n = a^b;
carry = (a&b) << 1;
"""
class Soultion {
    public int add(int a,int b) {
        if (b == 0) {
            return a;
        }
        return add(a^b,(a&b)<<1);
    }
}
```

å¯¹äºPythonéœ€è¦ç‰¹æ®Šè€ƒè™‘ï¼š

```python
class Solution: 
    def add(self, a: int, b: int) -> int:
        a = a&0xffffffff # æˆªæ–­æˆ32ä½æ•°å­—ï¼Œçœ‹å‡ºæ­£æ•°
        b = b&0xffffffff

        def helper(a,b):
            if b == 0:
                return a if a <= 0x7fffffff else ~(a^0xffffffff) # å¦‚æœä¸ºè´Ÿæ•°ï¼Œåˆ™è¦è¿˜åŸï¼Œå°†32ä½ä»¥ä¸Šçš„ä½å–åï¼Œ1åˆ°32ä½ä¸å˜
            return helper(a^b,(a&b)<<1&0xffffffff)
        
        return helper(a,b)
```



#### 7. æ•´æ•°åè½¬

æ€è·¯ï¼šå’Œä¸‹é¢190é¢˜æ€è·¯ç±»ä¼¼ï¼Œåªä¸è¿‡è¿™é‡Œéœ€è¦æ£€æŸ¥èŒƒå›´

```python
class Solution:
    def reverse(self, x: int) -> int:
        MAX_VAL = 2**31 - 1
        MIN_VAL = -2**31
        def check(ans):
            if ans > MAX_VAL or ans < MIN_VAL: return True
            return False

        sign = 1 if x >= 0 else -1
        x = abs(x)

        ans = 0
        while x > 0:
            digit = x % 10
            ans = ans * 10 + digit
            x = x // 10
            if check(sign*ans): return 0
        return sign*ans
```



#### 8. å­—ç¬¦ä¸²è½¬æ¢æ•´æ•° (atoi)

>   è¾“å…¥ï¼š"  123 4awwq"
>
>   çŠ¶æ€è½¬ç§»å›¾ï¼š
>
>   ![image-20210720151755487](images/image-20210720151755487.png)

```python
class Solution:
    def myAtoi(self, s: str) -> int:
        MAX_VAL = 2**31 - 1
        MIN_VAL = -2**31

        def check(ans):
            return ans > MAX_VAL or ans < MIN_VAL

        transfer = {
            0:{"blank":0,"sign":2,"digit":1},
            1:{"digit":1,"blank":3},
            2:{"digit":1},
            3:{"blank":3}
        }
        sign_map = {"+":1,"-":-1}

        start = 0
        ans = 0
        sign = 1

        for c in s:
            if c.isdigit(): action = "digit"
            elif c in "+-": action = "sign"
            elif c == " ": action = "blank"
            else: break

            start = transfer[start].get(action,None)
            if start is None: break
            else:
                # å°†è¿ç®—æ”¾åœ¨è¿™é‡Œçš„åŸå› æ˜¯ï¼šå¯¹äº"  123 4awwq"
                # å½“çŠ¶æ€åœ¨3æ—¶å€™ï¼Œæ­¤æ—¶è¾“å…¥ç©ºæ ¼è¿˜æ˜¯æ­£å¸¸çš„ï¼›
                # ä½†å¦‚æœå†é‡åˆ°æ•°å­—ï¼Œè¿™æ—¶å€™æ˜¯ä¸åˆæ³•çš„ï¼Œå¦‚æœå°†è¿ç®—æ”¾åœ¨ä¸Šé¢å–å¾—actionçš„æ—¶å€™ï¼Œå¾—åˆ°çš„ç»“æœ
                # æ˜¯å­˜åœ¨é—®é¢˜çš„
                if action == "digit":
                    ans = ans*10 + int(c)
                    if check(sign*ans):
                        return MAX_VAL if sign == 1 else MIN_VAL
                elif action == "sign":
                    sign = sign_map[c]
            
        return sign*ans
```



#### 9. å›æ–‡æ•°

>   æ€è·¯ï¼šé™¤äº†é‡‡ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åå‘è®¡ç®—å‡ºå›æ–‡æ•°æ®ï¼Œç„¶ååˆ¤æ–­æ„é€ å‡ºæ¥çš„æ•°æ®ä¸åŸå§‹æ•°æ®æ˜¯å¦ç›¸ç­‰çš„æ–¹å¼æ¥åˆ¤æ–­ã€‚

```java
class Solution {
    public boolean isPalindrome(int x) {
        if(x < 0) return false;
        int data = x;
        int ans = 0;
        while (data > 0) {
            ans = ans*10 + data%10;
            data /= 10;
        }
        return ans == x;
    }
}
```

#### 50. Pow(x, n)

```python
def fast_mul(x,n:int):
    ans = 1
    while n > 0:
        if (n & 1 == 1): 
            ans = ans * x
        x *= x
        n >>= 1
   return ans
```



#### 190 é¢ å€’äºŒè¿›åˆ¶ä½

>æ€è·¯ï¼šç§»ä½
>
>![image-20210720152031099](images/image-20210720152031099.png)

```java
public class Solution {
    // you need treat n as an unsigned value
    public int reverseBits(int n) {
        int res = 0;
        for(int i = 0; i < 32; i++) {
            res = (res << 1) | (n & 1); // reså·¦ç§»ä¸€ä½ï¼Œç„¶åå’Œnçš„æœ€åä¸€ä½æˆ–è¿ç®—
            n >>= 1; // n å¾€å³ç§»åŠ¨ä¸€ä½
        }
        return res;
    }
}
```

#### 231 æ£€æŸ¥2çš„å¹‚

æ€è·¯ï¼šæ£€æŸ¥ä¸€ä¸ªæ•°æ˜¯ä¸æ˜¯2çš„å¹‚ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªæ•°çš„äºŒè¿›åˆ¶æœ€ä½ä½1å±è”½ä¹‹åï¼Œæ£€æŸ¥å‰©ä½™çš„æ•°æ˜¯å¦ä¸º0ã€‚

```python
class Solution {
    public boolean isPowerOfTwo(int n) {
        return  (n > 0) && (n&(n-1)) == 0;
    }
}
```

æ‹“å±•ï¼šæ£€æŸ¥3çš„å¹‚ï¼Œ4çš„å¹‚ã€‚

```python
# æ£€æŸ¥3çš„å¹‚ï¼Œintæ˜¯æœ€å¤§ä¸º2^31-1ï¼Œè€Œå¯¹åº”çš„3çš„å¹‚çš„æœ€å¤§æ•°æ˜¯3^20
class Solution:
    def isPowerOfThree(self, n: int) -> bool:
        return (n > 0) and (3486784401 % n == 0)
    
    
# æ£€æŸ¥4çš„å¹‚ï¼Œ4çš„å¹‚å¿…ç„¶æ˜¯2çš„å¹‚ï¼Œå†åˆ¤æ–­å‰©ä¸‹çš„æ•°
class Solution:
    def isPowerOfThree(self, n: int) -> bool:
        return (n > 0) and (n&(n-1)) == 0 and n&0xaaaaaaaa
```



#### 421. æ•°ç»„ä¸­ä¸¤ä¸ªæ•°çš„æœ€å¤§å¼‚æˆ–å€¼ğŸ‰

>   æ€è·¯ï¼šå­—å…¸æ ‘å°†å¤æ‚åº¦é™åˆ°$O(n)$
>
>   ![image-20210720154834976](images/image-20210720154834976-1626767316688.png)

```python
class Solution:
    def findMaximumXOR(self, nums: List[int]) -> int:
        L = len(bin(max(nums)))-2 # æ±‚å‡ºæ‰€æœ‰æ•°å­—æœ€å¤§çš„é‚£ä¸ªæ•°çš„äºŒè¿›åˆ¶é•¿åº¦
        root = dict()

        for n in nums:
            node = root
            for i in range(L,-1,-1):
                v = (n >> i) & 1
                if v not in node:
                    node[v] = dict()
                    node = node[v]
                else:
                    node = node[v]
        res = 0

        for n in nums:
            node = root
            total = 0
            for i in range(L,-1,-1):
                v = (n >> i) & 1
                if 1-v in node:
                    total = (total<<1)|1
                    node = node[1-v]
                else:
                    total = total<<1
                    node = node[v]
            res = max(res,total)

        return res
```



#### 1835. æ‰€æœ‰æ•°å¯¹æŒ‰ä½ä¸ç»“æœçš„å¼‚æˆ–å’Œ

>   ![image-20211015172103116](images/image-20211015172103116.png)
>
>   æ€è·¯ï¼šéœ€è¦ç†è§£`(a&b)^(a&c)=a&(b^c)`

```java
class Solution {
    public int getXORSum(int[] arr1, int[] arr2) {
        int xor_a = 0, xor_b = 0;
        for(int arr:arr1) {
            xor_a ^= arr;
        }
        for(int arr:arr2) {
            xor_b ^= arr;
        }
        return xor_a&xor_b;
    }
}
```

#### 1486 æ•°ç»„å¼‚æˆ–æ“ä½œ ğŸ‰

æ€è·¯ï¼šåˆ©ç”¨å¼‚æˆ–è¿ç®—ã€‚[ğŸ”—](https://leetcode-cn.com/problems/xor-operation-in-an-array/solution/shu-xue-tui-dao-shi-jian-fu-za-du-o1de-f-b4kk/)

```java
class Solution {
    public int xorOperation(int n, int start) {
        int s = start >> 1;
        int prefix = xorOper(s-1)^xorOper(s+n-1); // æ„é€ ä¸¤ä¸ªæ˜¯ä»1å¼€å§‹çš„åºåˆ—ï¼Œä»è€Œä½¿ç”¨4i^(4i+1)^(4i+2)^(4i+3)=0
        int last = n&start&1; // å¤šä½™å‡ºæ¥çš„e
        int ans = prefix << 1 | last;
        return ans;
    }
    
    public int xorOper(int x) {
        int val = x % 4;
        if(val == 0) return x;
        else if(val == 1) return 1;
        else if(val == 2) return x+1;
        else return 0;
    }
}
```



#### 1734. è§£ç å¼‚æˆ–åçš„æ’åˆ— ğŸ‰

>   ![image-20210720154311342](images/image-20210720154311342.png)

```python
class Solution:
    def decode(self, encoded: List[int]) -> List[int]:
        """
        1. ä¿¡æ¯ä¸€ï¼špermæ˜¯nä¸ªæ­£æ•´æ•°çš„æ’åˆ—ï¼ˆæ‰€æœ‰çš„æ•°å­—åœ¨1~nä¹‹é—´ï¼‰ï¼Œ{1,2,3,4,5},n=5
        2. ä¿¡æ¯äºŒï¼šnæ˜¯ä¸ªå¥‡æ•°
        """
        n = len(encoded) + 1
        all_reduce = reduce(operator.xor,[i+1 for i in range(n)])
        odd_reduce = reduce(operator.xor,encoded[1::2])
        first = all_reduce^odd_reduce

        perm = [first]
        for i in range(len(encoded)):
            perm.append(perm[-1]^encoded[i])

        return perm
```



#### 1310. å­æ•°ç»„å¼‚æˆ–æŸ¥è¯¢

>   æ€è·¯ï¼šå‰ç¼€å’Œæ±‚è§£ã€‚
>
>   ![image-20210720154158580](images/image-20210720154158580.png)

```java
class Solution {
    public int[] xorQueries(int[] arr, int[][] queries) {
        int m = arr.length;
        int n = queries.length;

        int [] xor_arr = new int[m+1];
        xor_arr[0] = 0;
        for(int i = 1; i <= m; i++) {
            xor_arr[i] = arr[i-1]^xor_arr[i-1];
        }

        int [] ans = new int[n];
        for(int i = 0; i < n; i++) {
            ans[i] = xor_arr[queries[i][0]]^xor_arr[queries[i][1]+1];
        }
        return ans;
    }
}
```



#### 810. é»‘æ¿å¼‚æˆ–æ¸¸æˆ ğŸ‰

>   ![image-20210917202859078](images/image-20210917202859078.png)
>
>   +   å‡è®¾æ­¤æ—¶å¶æ•°æ•°ç»„æ‰€æœ‰æ•°çš„å¼‚æˆ–å€¼ä¸º0ï¼Œé‚£ä¹ˆAliceå°±ç›´æ¥è·èƒœã€‚(è§„åˆ™2)
>   +   å¦‚æœæ­¤æ—¶å¶æ•°æ•°ç»„æ‰€æœ‰æ•°çš„å¼‚æˆ–å€¼ä¸ä¸º0ã€‚å¾—åˆ°ç»“è®ºï¼š**è‡³å°‘æœ‰2ä¸ªä»¥ä¸Šçš„æ•°ä½¿å…¶æ•°ç»„çš„å¼‚æˆ–å€¼ä¸ä¸º0**(è®°ä½œ$a,b$)ã€‚Aliceä¼šé€‰è¿™ä¸¤ä¸ªæ•°ä¸­çš„ä¸€ä¸ªï¼Œå‡è®¾ä»–é€‰äº†$a$ã€‚æ­¤æ—¶Bobæœ‰ä¸¤ç§æ–¹å¼ï¼šé€‰å‰©ä¸‹çš„$b$, é‚£ä¹ˆæ­¤æ—¶æ•°ç»„é•¿åº¦åˆå›åˆ°äº†å¶æ•°ã€‚æƒ…å†µä¸€ï¼šæ­¤æ—¶æ•°ç»„å¼‚æˆ–å€¼ä¸º0ï¼Œé‚£ä¹ˆAliceè·èƒœã€‚æƒ…å†µäºŒï¼šæ•°ç»„å¼‚æˆ–å€¼ä¸ä¸º0ï¼Œé‚£ä¹ˆåˆå›åˆ°äº†æ­¥éª¤2ï¼Œè¿™ä¸€æ­¥å¯ä»¥ä¸€ç›´åˆ°æ•°ç»„çš„æ•°è¢«é€‰å®Œï¼Œç„¶åè½®åˆ°Aliceé€‰ï¼Œç©ºæ•°ç»„Aliceè·èƒœ(è§„åˆ™ä¸‰)ã€‚å¦‚æœBobä¸é€‰bï¼Œé‚£ä¹ˆè½®åˆ°Aliceé€‰æ—¶ï¼Œä»–ä¹Ÿè·³è¿‡bï¼Œå› ä¸º bb æœ‰å¯èƒ½æ˜¯æ­¤æ—¶å”¯ä¸€çš„æ•°é€‰å®Œåæ•°ç»„çš„å¼‚æˆ–å€¼ä¸º0ã€‚è¯¦ç»†çœ‹å›¾ã€‚
>   +   æˆ‘ä»¬çŸ¥é“å¶æ•°å…ˆé€‰æ–¹æ˜¯ä¸€å®šè·èƒœçš„ï¼é‚£ä¹ˆå¯¹äºBobä¹Ÿæ˜¯åŒç†ï¼Œå¦‚æœAliceæ˜¯å¥‡æ•°æ–¹ï¼Œç„¶åé€‰å»ä¸€ä¸ªæ•°å­—åæ•°ç»„å˜ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆBobæ­¤æ—¶ä¸€å®šä¼šè·èƒœã€‚é‚£ä¹ˆæ­¤æ—¶Aliceåªæœ‰ä¸€ç§æƒ…å†µä¼šèµ¢ï¼Œé‚£å°±æ˜¯åœ¨ä»–ç¬¬ä¸€æ¬¡é€‰çš„æ—¶å€™ï¼Œé»‘æ¿ä¸Šæ‰€æœ‰æ•°çš„å¼‚æˆ–å€¼å°±å·²ç»ä¸º0äº†(è§„åˆ™äºŒ)ã€‚

```python
class Solution:
    def xorGame(self, nums: List[int]) -> bool:
        return reduce(operator.xor,nums) == 0 or len(nums) % 2 == 0 
```



## 2. å’Œ  `è¿›ä½/é˜¶å±‚/æ±‚å’Œ/ç›¸ä¹˜/ç›¸é™¤/ç›¸å‡`ç›¸å…³

ä¸¤ä¸ªæ•°å­—çš„æ±‚å’Œï¼Œåœ¨æ•°å­¦è¿ç®—ä¸Šæ˜¯æŒ‰ç…§ä»ä½ä½åˆ°é«˜ä½çš„æ±‚å’Œè¿‡ç¨‹ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹æœ‰ä¸¤ä¸ªï¼š

+   ä¸€ä¸ªæ˜¯åœ¨æ¯ä½è¿ç®—çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„`è¿›ä½`å’Œ`ä½™æ•°`çš„è®¡ç®—
+   ä¸€ä¸ªæ˜¯åœ¨æœ€é«˜ä½è®¡ç®—ä¹‹åï¼Œéœ€è¦åˆ¤æ–­æ˜¯å¦éœ€è¦è¿›ä¸€æ­¥è¿›ä½ï¼Œæ¯”å¦‚`5+5=10`ï¼Œè¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æ„å»ºä¸€ä¸ªåä½æ•°ã€‚

####  å‘ä¸Šå–æ•´ å’Œ å‘ä¸‹å–æ•´

```python
# (left+right+1) // 2
data = (left + right + 1) >> 1 

# å‘ä¸Šå–æ•´,
def ceil(a,b):
    return (a-1)//b + 1

# å‘ä¸‹å–æ•´
def floor(a,b):
    return a // b
```

#### æœ€å¤§å…¬çº¦æ•°å’Œæœ€å°å…¬å€æ•°

```python
def gcd(a,b):
    return a if b == 0 else gcd(b,a%b)

def lcm(a,b):
    return a*b // gcd(a,b)
```



#### 2.ä¸¤æ•°ç›¸åŠ 

æ€è·¯ï¼š
+ 1. å®šä¹‰dummyæŒ‡é’ˆï¼ŒæŒ‡å‘p1
+ 2. å®šä¹‰prevæŒ‡é’ˆï¼Œè¡¨ç¤ºå½“å‰æŒ‡é’ˆçš„å‰ä¸€æŒ‡é’ˆ
+ 3. å®šä¹‰carryè¡¨ç¤ºè¿›ä½
+ 4. carryä¸ç­‰äº0ï¼Œè®¡ç®—æœ€åä¸€ä¸ªèŠ‚ç‚¹

```java
/**
 * Definition for singly-linked list.
 * public class ListNode {
 *     int val;
 *     ListNode next;
 *     ListNode() {}
 *     ListNode(int val) { this.val = val; }
 *     ListNode(int val, ListNode next) { this.val = val; this.next = next; }
 * }
 */
class Solution {
public ListNode addTwoNumbers(ListNode l1, ListNode l2) {
        ListNode dummy = new ListNode(-1);
        dummy.next = l1;
        ListNode prev = dummy;
        int carry = 0;
        while(l1 != null && l2 != null) {
            l1.val = l1.val + l2.val + carry;
            carry = l1.val / 10;
            l1.val %= 10;
            prev = l1;
            l1 = l1.next;
            l2 = l2.next;
        }
        if (l1==null) {
            prev.next = l2;
            while(l2 != null) {
                l2.val += carry;
                carry = l2.val / 10;
                l2.val %= 10;
                prev = l2;
                l2 = l2.next;
            }
        } else if(l2 == null) {
            while(l1 != null) {
                l1.val += carry;
                carry = l1.val / 10;
                l1.val %= 10;
                prev = l1;
                l1 = l1.next;
            }
        }
        if(carry > 0) prev.next = new ListNode(carry);
        return dummy.next;
    }
}
```



#### 29. ä¸¤æ•°ç›¸é™¤ ğŸ‰

>   æ€è·¯ï¼š
>
>   ![image-20210720152627484](images/image-20210720152627484.png)

```python
class Solution:
    def divide(self, dividend: int, divisor: int) -> int:
        MAX_VAL = 2147483647
        MIN_VAL = -2147483648
        def fast(x,n): # è®¡ç®— x*n
            ans = 0
            while n > 0:
                if n&1: ans += x
                n >>= 1
                x += x
            return ans
        
        sign = 1
        if (dividend > 0 and divisor < 0) or (dividend < 0 and divisor > 0):
            sign = -1
        
        dividend = abs(dividend)
        divisor = abs(divisor)
        left,right = 0,dividend
        while left <= right:
            mid = left + right >> 1
            val = fast(divisor,mid)
            if val < dividend: left = mid + 1
            elif val == dividend:
                left = mid
                break
            else: right = mid - 1
        
        ans = left*sign
        if ans > MAX_VAL  or ans < MIN_VAL: return MAX_VAL
        else: return ans
        

```

#### 69 æ±‚è§£sqrt

```python
# ç‰›é¡¿æ³•ï¼Œç‰›é¡¿æ³•å¯ä»¥å‘ä¸¤è¾¹æœï¼Œæ‰€ä»¥ç›´æ¥å–
class Solution:
    def mySqrt(self, x: int) -> int:
        f = lambda x,num: x*x - num
        f_prime = lambda x: 2*x

        num = x
        start = num / 2

        while abs(f(start,num)) >= 10e-5:
            start = start - (f(start,num)) / (f_prime(start))
        
        return int(start)

# äºŒåˆ†æ³•ï¼Œç²¾ç¡®è§£ï¼Œç„¶åå–æ•´ï¼ŒäºŒåˆ†æ³•åœ¨æ±‚è§£çš„æ—¶å€™éœ€è¦æ³¨æ„èŒƒå›´ï¼Œåªèƒ½åœ¨leftå’Œrightä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªèŒƒå›´è¦å¤§ä¸€ç‚¹
class Solution:
    def mySqrt(self, x: int) -> int:
        if x <= 1: return x
        left,right = 0,x//2+1 # ç¡®å®šèŒƒå›´
        ans = 0
        while left <= right:
            mid = (left+right) / 2
            val = mid*mid - x
            if abs(val) < 10e-6:
                ans = int(round(mid,5))
                break
            elif val > 0:
                right = mid
            else:
                left = mid
        return ans
    
class Solution:
    def mySqrt(self, x: int) -> int:
        if x == 0 or x == 1: return x
        l = 1
        r = x
        ans = 0
        while l < r:
            mid = l + (r - l) // 2
            if mid <= x // mid:
                ans = mid
                l = mid + 1
            else:
                r = mid
        return ans
```



#### 172. é˜¶ä¹˜åçš„é›¶ ğŸ‰

>   æ€è·¯ï¼šå¯¹äºä¸€ä¸ªé˜¶ä¹˜åçš„æ•°å­—ï¼Œæœ«å°¾çš„é›¶çš„ä¸ªæ•°å–å†³äºå› å­ä¸­5çš„ä¸ªæ•°ï¼Œ

```java
class Solution {
    public int trailingZeroes(int n) {
        int cnt = 0;
        while(n >= 5) {
            n = n/5;
            cnt += n;
        }
        return cnt;
    }
}
```

#### 172 å˜å½¢é¢˜

>   é˜¶å±‚åï¼Œ2è¿›åˆ¶ä¸­æœ€åä¸€ä¸ª1çš„ä½ç½®
>
>   æ€è·¯ï¼šç­‰ä»·äºæ±‚å› å­ä¸­2çš„ä¸ªæ•°

```java
public int trailingZeroes(int n) {
    int cnt = 0;
    while (n > 0) {
        n /= 2;
        cnt += n;
    }
    return cnt;
}
```

å¯ä»¥ç”¨ä¸‹é¢çš„è„šæœ¬éªŒè¯ï¼š

```python
data = math.factorial(30)
cnt = int(math.log2(data-(data&(data-1))))
```

#### 233 æ•°å­—1çš„ä¸ªæ•°

>   ![image-20210723112138449](images/image-20210723112138449.png)
>
>   æ€è·¯ï¼š
>
>   ![image-20210723112119430](images/image-20210723112119430.png)

```python
class Solution:
    def countDigitOne(self, n: int) -> int:
        # æˆªå–å½“å‰æœ€ä½ä½
        ans = 0
        count = 1
        
        while count <= n:
            high = n // (count*10)
            cur = n % (count*10) // count
            low = n % (count*10) % count

            if cur == 0:
                ans += high*count
            elif cur == 1:
                ans += high*count + low + 1
            else:
                ans += high*count + count

            count = count*10
        return ans
```



#### 258 å„ä½ç›¸åŠ 

>   æ€è·¯ï¼šå¯¹äºä¸€ä¸ªæ•°ï¼Œ`abcd`ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š
>   $$
>   abcd=a*1000+b*100+c*10+d=(999a+99b+9c)+(a+b+c+d)
>   $$
>   é‚£ä¹ˆï¼Œå¯ä»¥å¾—åˆ°ï¼š
>   $$
>   \begin{align}
>   abcd\%9&=(a+b+c+d)\%9 \\
>   (a+b+c+d)\%9 &= (x+y+z+q) \% 9 \\
>   \cdots &= \cdots \\
>   \cdots &= ans \\
>   \end{align}
>   $$
>   è¿™æ ·ä¹Ÿå°±å¯ä»¥å¾—åˆ°ä¸‹é¢çš„ç­‰å¼ï¼š
>   $$
>   abcd\%9=(a+b+c+d)\%9=\cdots = ans
>   $$

æ‰€ä»¥å¯ä»¥å¯åˆ°ç­”æ¡ˆï¼š

```python
class Solution:
    def addDigits(self, num: int) -> int:
        if num == 0: return num
        val = num % 9
        return 9 if val == 0 else val
```

#### 263 ä¸‘æ•°

>   æ€è·¯ï¼š
>
>   ![image-20210720160529099](images/image-20210720160529099.png)

```python
class Solution:
    def isUgly(self, num: int) -> bool:
        if num<1:
            return False
        while num%2==0:
            num/=2
        while num%3==0:
            num/=3
        while num%5==0:
            num/=5
        return num==1
```



#### 264 ä¸‘æ•° II

>   ![image-20210720160954343](images/image-20210720160954343.png)

```python
class Solution:
    def nthUglyNumber(self, n: int) -> int:
        k = n
        H = []
        heapify(H)
        heappush(H,[1,0])
        nums = [2,3,5]
        n = len(nums)

        while True:
            cur,start = heappop(H)
            k -= 1
            if k == 0: return cur
            for i in range(start,3):
                heappush(H,[cur*nums[i],i]) # ä¿è¯æ•°æ®æŒ‰ç…§1,3,5,7,9,15,21,...       
```



#### 991. åäº†çš„è®¡ç®—å™¨ ğŸ‰

>   ![image-20211011181610791](images/image-20211011181610791.png)
>
>   +   å½“ `Y` æ˜¯å¶æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ä»ä¸¤ä¸ªæ•°å¾—åˆ°ï¼š$2*T\rightarrow Y$ æˆ–è€… $(2*T+1)-1=Y$
>   +   å½“ `Y` æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆåªèƒ½ä»: $(Y+1)/2 = X$

```python
class Solution:
    def brokenCalc(self, startValue: int, target: int) -> int:
        """ æ•°æ®èŒƒå›´ä¸€å®šè¦é—®æ¸…æ¥šï¼ï¼ï¼ """
        x,y = startValue,target
        ans = 0
        while y > x:
            ans += 1
            if y%2: y += 1
            else: y //= 2
        return ans+x-y
```

#### 628. ä¸‰ä¸ªæ•°çš„æœ€å¤§ä¹˜ç§¯

>   ![image-20211011183924848](images/image-20211011183924848.png)
>
>   å…³é”®æ˜¯æ‰¾åˆ°æœ€å¤§çš„ä¸‰ä¸ªæ•°å’Œæœ€å°çš„ä¸¤ä¸ªæ•°ï¼Œå¯ä»¥åˆ©ç”¨æ’åºç®—æ³•ç›´æ¥æ±‚å‡ºï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ç®€å•çš„æ¯”è¾ƒåœ¨ $O(N)$ çš„æ—¶é—´å†…æ‰¾åˆ°ç­”æ¡ˆã€‚

```python
min1 = min2 = float("inf")
max1 = max2 = max3 = -float("inf")
for num in nums:
    if num < min1:
        min2 = min1
        min1 = num
    elif num < min2:
        min2 = num
    
    if num > max1:
        max3 = max2
        max2 = max1
        max1 = num
    elif num > max2:
        max3 = max2
        max2 = num
    elif num > max3:
        max3 = num
print(min1,min2,max3,max2,max1)
```



#### é¢è¯•ï¼šæ±‚è§£å¼€næ¬¡æ–¹

```python
def solution(a:float,n:int):
    def fast(x,n):
        ans = 1
        while n > 0:
            if n&1 == 1: ans *= x
            x *= x
            n >>= 1
        return ans
    
    if a == 0 or n == 0: return 0
    if n > 0:
        f = lambda x,n,a:fast(x,n)-a
    elif n < 0:
        f = lambda x,n,a:fast(x,n)-1/a
    n = abs(n)

    right = max(0,a)
    left = min(0,a)
    while left < right:
        mid = left + (right-left)/2
        val = f(mid,n,a)
        if abs(val) < 10e-5:
            break
        elif val > 0:
            right = mid
        else:
            left = mid
    print("ans: {:.3}".format(mid))
```



#### ç‰›é¡¿æ³•

![image-20210824203345199](images/image-20210824203345199.png)

+   ç¡®å®šæœç´¢èŒƒå›´ï¼Œä»¥åŠå‡½æ•°çš„å•è°ƒæ€§ï¼ˆå¦‚æœæ˜¯å•è°ƒå‡½æ•°ï¼Œæœ€å¥½æ˜¯ä»å®šä¹‰åŸŸçš„ä¸­é—´å¼€å§‹æœç´¢ã€‚ï¼‰

+   ç›®æ ‡å€¼è¿­ä»£ã€‚

+   è¾“å…¥ï¼šåˆå§‹å€¼$x_0$ï¼Œå‡½æ•°$f(x)$ï¼Œå‡½æ•°çš„å€’æ•°$f'(x)$

+   è¿­ä»£å…¬å¼ï¼š
    $$
    x_k=x_{k-1}-\frac{f(x_{k-1})}{f'(x_{k-1})}
    $$

+   ä»£ç ï¼Œå¯¹äº$a^{\frac{1}{n}}=x$ï¼Œæ±‚è§£$x$ã€‚è½¬åŒ–æˆæ±‚è§£$f(x)=x^n-a=0$ è¿™ä¸ªé—®é¢˜

    ```python
    /*
    a = 12512142, n = 12541
    */
    import math
    import matplotlib.pyplot as plt
    import numpy as np
    
    def fast(x,n):
        ans = 1
        while n > 0:
            if n&1 == 1: ans *= x
            x *= x
            n >>= 1
        return ans
    
    def solution(a:float,n:int):
        if n > 0: f = lambda x,n,a:fast(x,n)-a
        elif n < 0: f = lambda x,n,a:fast(x,n)-1/a
        else: return 0
        n = abs(n)
        f_prime = lambda x,n:n*fast(x,n-1)
        start = a
        while abs(f(start,n,a)) >= 10e-5:
            start = start - f(start,n,a) / f_prime(start,n)
        print("ans: {:.3}".format(start))
    
    a = 45.124
    n = -3
    solution(a,n)
    ```

+   ç‰›é¡¿æ³•å¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼Œéç‚¹é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé‡åˆ°å¯¼æ•°ä¸º0ï¼Œè¿™æ ·åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå¯¼æ•°å°±ç­‰äº0ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡Œè¿­ä»£äº†ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å®šä¹‰å¼€å§‹æœç´¢ç‚¹ä¸º$a$ï¼Œè€ŒäºŒåˆ†æ³•ä¸­æ›´å¸¸è§çš„æ˜¯å®šä¹‰ä¸º$[0,a//2]$æˆ–è€…$[a//2,0]$

    
    
    ![](images/xxxsrqfqweqf.png)







#### ç®—æ•°åŸºæœ¬å®šç†ï¼ˆè´¨å› æ•°åˆ†è§£ï¼‰

ä»»ä½•ä¸€ä¸ªå¤§äº1çš„è‡ªç„¶æ•°ï¼Œéƒ½å¯ä»¥è¢«åˆ†è§£ä¸ºè´¨æ•°çš„ä¹˜ç§¯ã€‚

ä¸€ä¸ªè‡ªç„¶æ•°ï¼Œè¢«åˆ†è§£æˆä¸¤ä¸ªæ•°ï¼Œè¿™ä¸¤ä¸ªæ•°ä¸€å®šæœ‰ä¸€ä¸ªæ˜¯å°äºç­‰äº`sqrt(n)`ï¼Œä¸€ä¸ªå¤§äº`sqrt(n)`ã€‚

```python
def divide_primes(num):
    """
    åˆ†è§£è´¨å› æ•°
    @think ç±»ä¼¼äºä¸‘æ•°çš„è®¡ç®—æ–¹å¼ï¼Œä½†æ˜¯æ›´ç®€å•
    """
    ans = []
    a = 2
    while a*a <= num:
        """
            æŒ‰ç…§2,3,5,7çš„é¡ºåºä¾æ¬¡åˆ†è§£ï¼Œä½†æ˜¯4å¯ä»¥è¢«åˆ†è§£ä¸º2*2ï¼Œæ‰€ä»¥å¯¹åº”çš„cntä¸º0ã€‚
            ä¸€ç§ä¼˜åŒ–çš„åšæ³•æ˜¯å®ç°è®¡ç®—å‡ºç´ æ•°ï¼š{2,3,5,7,11,...}
        """
        cnt = 0
        while num % a == 0:
            cnt += 1
            num //= a
        ans += [str(a) for i in range(cnt)]
        a += 1
    if num > 1:
        ans += [str(num)]
    return "*".join(ans)
```



#### 254. Factor Combinations å› å­ç»„åˆ ğŸ‰

>   è´¨å› æ•°æ±‚è§£
>
>   ![image-20210720161335845](images/image-20210720161335845.png)
>
>   ![image-20210720161351174](images/image-20210720161351174.png)

```python
def getFactors(n):
    ans = []
    path = []
    def helper(n,div):
        if n < div: return
        a = div
        while a*a <= n:
            if n % a == 0:
                path.append(a)
                path.append(n//a)
                ans.append(path[:]) # ç‚¹åˆ°ä¸ºæ­¢ï¼Œç»§ç»­æ‹†åˆ†
                path.pop()
                helper(n//a,a)
                path.pop()
            a += 1
    helper(n,2)
    return ans
```

#### ç´ æ•°ç­›é€‰ ğŸ‰

```python
# åŸƒæ°ç­›é€‰
class Solution:
    def countPrimes(self, n: int) -> int:
        isPrime = [True]*n
        i = 2
        while i*i < n:
            if isPrime[i]:
                j = i*i
                while j < n:
                    isPrime[j] = False
                    j = j + i
            i += 1
        return len([i for i in range(2,n) if isPrime[i]])

```



#### æœ€å¤§è´¨å› æ•° ğŸ‰

```python
def find(k):
    for i in range(k//2,1,-1):
        if k % 1 == 0:
            return i
    return 1
```

## 3. å‡ ä½•ç³»åˆ— ğŸ‰

çº¿æ€§æ–¹ç¨‹æœ‰ä¸‰ç§è¡¨è¾¾æ–¹å¼ï¼š

+   æ–œæˆªå¼ï¼š

$$
y=kx+b
$$

+   æˆªè·å¼ï¼š

$$
\frac{x}{a} + \frac{y}{b}=1
$$

+   ä¸€èˆ¬å¼æ–¹ç¨‹ï¼š

$$
ax+by+c=0
$$



##### ç»™å®šä¸¤ç‚¹åæ ‡ï¼Œå¦‚ä½•ç¡®å®šç›´çº¿ï¼Ÿ

+   ä¸€èˆ¬æ–¹ç¨‹å¼æ±‚è§£å…¬å¼

$$
\begin{align}
a&=x_2-x_1 \\
b&=-(y_2-y_1) \\
c&=-(y_1*(x_2-x_1)-x_1*(y_2-y_1))
\end{align}
$$

+   å½’ä¸€åŒ–

$$
a = \frac{a}{\sqrt{a^2+b^2+c^2}} \\
b = \frac{b}{\sqrt{a^2+b^2+c^2}} \\
c = \frac{c}{\sqrt{a^2+b^2+c^2}}
$$

##### é¢è¯•é¢˜ 16.03. äº¤ç‚¹

æ€è·¯ï¼š

+   æ ¹æ®ä¸¤ä¸ªç‚¹å°†ç›´çº¿è¡¨è¾¾å‡ºæ¥ï¼Œç„¶åæ±‚å‡ºä¸¤ä¸ªç›´çº¿çš„äº¤ç‚¹ã€‚ï¼ˆå¦‚æœä¸¤ä¸ªç›´çº¿å¹³è¡Œï¼Œåˆ™è¿›å…¥ç‰¹æ®Šåˆ¤æ–­ï¼‰
+   åˆ¤æ–­äº¤ç‚¹æ˜¯å¦åœ¨ä¸¤ä¸ªç›´çº¿ä¸Šï¼Œå¦‚æœåœ¨ï¼Œåˆ™è¾“å‡ºäº¤ç‚¹ï¼›å¦åˆ™ï¼Œè¡¨ç¤ºä¸¤ä¸ªç›´çº¿ä¸ç›¸äº¤ã€‚
+   ç‰¹æ®Šåˆ¤æ–­ï¼šå¦‚æœä¸¤ä¸ªç›´çº¿å¹³è¡Œï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªçº¿æ®µæœ‰å‡ ç§å¯èƒ½ï¼Œå¯èƒ½å®Œå…¨ç›¸ç¦»ï¼Œå¯èƒ½åªæœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œå¯èƒ½æœ‰å¤šä¸ªäº¤ç‚¹ï¼Œå¯èƒ½å®Œå…¨å†…å«ã€‚è¿™æ—¶å€™åªéœ€è¦å¯¹å››ä¸ªé¡¶ç‚¹è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­é¡¶ç‚¹æ˜¯å¦å­˜åœ¨çº¿æ¡å†…ï¼Œç„¶åå¯¹åœ¨çº¿æ¡å†…çš„ç‚¹è¿›è¡Œæ’åºã€‚



#### 149. ç›´çº¿ä¸Šæœ€å¤šçš„ç‚¹æ•°

>   ![image-20210913105441495](images/image-20210913105441495.png)
>
>   ä¸€èˆ¬æ–¹ç¨‹å¼ + æ³•å‘é‡å½’ä¸€åŒ– + ä¿ç•™å°æ•°

```python
class Solution:
    def maxPoints(self, points: List[List[int]]) -> int:
        def getKey(p1,p2):
            x1,y1 = p1
            x2,y2 = p2
            a = x2-x1
            b = -(y2-y1)
            c = -(y1*(x2-x1)-x1*(y2-y1))

            base = math.sqrt(a*a+b*b+c*c)
            digit = 10
            a,b,c = round(a/base,digit),round(b/base,digit),round(c/base,digit)
            if a < 0: a,b,c = -a,-b,-c
            elif a == 0:
                if b < 0: b,c = -b,-c
                elif b == 0:
                    if c < 0: c = -c
            return a,b,c

        n = len(points)
        line_dict = collections.defaultdict(set)
        for i in range(n):
            for j in range(i+1,n):
                a,b,c = getKey(points[i],points[j])
                line_dict[(a,b,c)].add(tuple(points[i]))
                line_dict[(a,b,c)].add(tuple(points[j]))

        ans = 1
        for k,v in line_dict.items():
            ans = max(ans,len(v))
        return ans
```



## 4. åæ ‡è½¬æ¢ç±»å‹

#### Floydåˆ¤åœˆæ³•

>   è®¾å®šï¼Œä»èµ·ç‚¹åˆ°ç¯èµ·ç‚¹è·ç¦»ä¸º$a$,ä»ç¯èµ·ç‚¹é¡ºæ—¶é’ˆåˆ°ç›¸é‡ç‚¹é•¿åº¦ä¸º$b$ï¼Œä»ç›¸é‡ç‚¹åˆ°èµ·ç‚¹ä¸º$c$ã€‚

åˆ™ï¼Œæ…¢æŒ‡é’ˆè¡Œè¿›çš„è·ç¦»$S$å¦‚ä¸‹ï¼Œ
$$
S=a+A(b+c)+b
$$
å¿«æŒ‡é’ˆè¡Œè¿›çš„è·ç¦»$2S$å¦‚ä¸‹ï¼Œ
$$
2S=a+B(b+c)b
$$
å¯ä»¥å¾—åˆ°ï¼š
$$
S=(B-A)(b+c)
$$
è¯´æ˜å¿«æ…¢æŒ‡é’ˆè¡Œè¿›çš„è·ç¦»æ­£å¥½æ˜¯ç¯é•¿åº¦çš„å€æ•°ï¼Œå°†æ…¢æŒ‡é’ˆç§»åŠ¨åˆ°èµ·ç‚¹ï¼Œç„¶åè¡Œè¿›é•¿åº¦ä¸º$a$çš„è·ç¦»ï¼Œåˆ™å¿«æŒ‡é’ˆè¡Œè¿›çš„è·ç¦»ä¸º
$$
2S+a
$$
è€ƒè™‘åˆ°Så¼ç¯é•¿åº¦çš„å€æ•°ï¼Œè‹¥ä»¥æ­¤æ—¶å¿«æŒ‡é’ˆæ­£å¥½æ‰§è¡Œç¯å¼€å§‹çš„åæ ‡ã€‚





#### å‰‘æŒ‡ Offer 29. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ

å…¬å¼æ³•ä¸­ï¼Œè¯·å‚è€ƒLCP 29çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™é¢˜æœ€å¿«çš„åšæ³•æ˜¯æ¨¡æ‹Ÿç¢°å£æ³•å¿«é€Ÿæ±‚è§£ã€‚

+   java

```java
class Solution {
    public int[] spiralOrder(int[][] matrix) {

        int m = matrix.length;
        if (m == 0) return new int[0];
        int n = matrix[0].length;
        if (n == 0) return new int[0];

        int l = 0, r = n, u = 0, d = m;
        int [] ans = new int[m*n];
        int idx = 0;
        while(true) {
            for(int i = l; i < r; i++) {
                ans[idx++] = matrix[u][i];
            }
            u += 1;
            if (u >= d) break;
            for(int i = u; i < d; i++) {
                ans[idx++] = matrix[i][r-1];
            }
            r -= 1;
            if (l >= r) break;
            for (int i = r-1; i >= l; i--) {
                ans[idx++] = matrix[d-1][i];
            }
            d -= 1;
            if (u >= d) break;
            for (int i = d-1; i >= u; i--) {
                ans[idx++] = matrix[i][l];
            }
            l += 1;
            if (l >= r) break;
        }
        return ans;   
    }
}
```



#### LCP 29. ä¹å›¢ç«™ä½

æ€è·¯ï¼šåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š

+   ç¬¬ä¸€éƒ¨åˆ†æ˜¯æ‰¾åˆ°å¤–å±‚æœ‰å¤šå°‘å…ƒç´  $\rightarrow$   å¯»æ‰¾å¤–å±‚å±‚æ•° $\rightarrow$ ç¦»å››ä¸ªè¾¹ç•Œæœ€çŸ­çš„è·ç¦»
+   ç¬¬äºŒéƒ¨åˆ†æ˜¯æ‰¾åˆ°å†…å±‚æœ‰å¤šå°‘å…ƒç´ ï¼ŒæŒ‰ç…§`ä¸Šå³ä¸‹å·¦`å››ä¸ªé¡ºåºè¿›è¡Œè®¡ç®—
+   python

```python
# python
class Solution:
    def orchestraLayout(self, num: int, xPos: int, yPos: int) -> int:
        def get_pos(x,y,m,n):
            """
            x,yæ˜¯ä¸‹æ ‡ä»1å¼€å§‹çš„åæ ‡
            """
            k = min(min(x-1,n-y),min(y-1,m-x)) # å¯»æ‰¾å±‚æ•°
            outer_eles = k*(2*m+2*n-4*k) # ç­‰å·®æ•°åˆ—æ±‚å’Œ
            inner_eles = get_inner(x-k,y-k,m-2*k,n-2*k) # 
            return outer_eles + inner_eles

        def get_inner(x,y,m,n):
            if x == 1: return y
            if y == n: return x+n-1
            if x == m: return 2*n+m-y-1
            if y == 1: return 2*m+2*n-x-2
            return 0 # default case
        
        pos = get_pos(xPos+1,yPos+1,num,num)

        return 9 if pos%9 == 0 else pos%9
```

+   java å¦‚ä½•å¤„ç†å¤§æ•°é—®é¢˜ BigInteger

```java
import java.math.BigInteger;
class Solution {
    public int orchestraLayout(int num, int xPos, int yPos) {
        BigInteger pos = get_pos(xPos+1,yPos+1,num,num);
        int val = pos.mod(BigInteger.valueOf(9)).intValue();
        return (val == 0) ? 9 : val;
    }

    public BigInteger get_pos(int x, int y, int m, int n) {
        int k = Math.min(Math.min(x-1, n-y),Math.min(y-1, m-x));
        BigInteger inner_eles = get_inner(x - k, y - k, m - 2*k, n - 2*k);
        BigInteger outer_eles = BigInteger.valueOf(k).multiply(
                BigInteger.valueOf(2).multiply(BigInteger.valueOf(m+n)).subtract(
                        BigInteger.valueOf(4).multiply(BigInteger.valueOf(k)))
                
                );

        return outer_eles.add(inner_eles);
    }
    public BigInteger get_inner(int x,int y,int m,int n) {
        if(x==1) return BigInteger.valueOf(y);
        if(y==n) return BigInteger.valueOf(x+n-1);
        if(x==m) return BigInteger.valueOf(2).multiply(BigInteger.valueOf(n)).add(
                BigInteger.valueOf(m).subtract(BigInteger.valueOf(y+1))
        ); 
        if(y==1) return BigInteger.valueOf(2).multiply(BigInteger.valueOf(m)).add(
                BigInteger.valueOf(2).multiply(BigInteger.valueOf(n)).subtract(
                        BigInteger.valueOf(x+2)
                )
        );
        return BigInteger.valueOf(0);
    }
}
```



#### å¾ªç¯å–ä½™

+   æ•°æ®åœ¨[1,...,n]ä¸­ï¼Œå°†æ•°æ®æ˜ å°„åˆ°[1,m]ä¸­

    ```python
    n = 100
    m = 9
    nums = [i for i in range(1,n+1)]
    data = [(num-1)%m+1 for num in nums]
    print(data)
    ```

+   æ•°æ®åœ¨[0,...,n]ä¸­ï¼Œå°†æ•°æ®æ˜ å°„åˆ°[0,m]ä¸­

    ```python
    n = 100
    m = 9
    nums = [i for i in range(1,n+1)]
    data = [(num)%m for num in nums]
    print(data)
    ```

+   å¦‚æœæƒ³æŠŠæ•°æ®èŒƒå›´æ§åˆ¶åœ¨[1,3]ä¸­ï¼Œæ•°æ®æ˜¯ä»ä¸‹æ ‡ä¸º1å¼€å§‹çš„

    ```python
    n = 100
    m = 3
    nums = [i for i in range(1,n+1)]
    data = [(num-1)%m+1 for num in nums]
    print(data)
    ```

    

#### å‰‘æŒ‡ Offer 44. æ•°å­—åºåˆ—ä¸­æŸä¸€ä½çš„æ•°å­—

```python
class Solution:
    def findNthDigit(self, n: int) -> int:
        import math
        if n < 10: return n 
        N = n + 1 # Nè¡¨ç¤ºå«ä¹‰æ˜¯ç¬¬Nä¸ªæ•°ï¼Œä¸‹æ ‡ä»1å¼€å§‹
        start = 1 # åˆå§‹åŒ–ä¸º1ï¼Œè¡¨ç¤º012345678910çš„ç¬¬ä¸€ä¸ª0
        cnt = 0 # è¡¨ç¤ºå½“å‰çš„ä½æ•°
        while N > 0:
            if N - start > 0: N -= start # è¡¨ç¤ºå½“å‰è¿˜æœ‰ä½™æ•°
            else: break
            # 9 * pow(10,cnt)ï¼Œ9,90,900ç­‰è¡¨ç¤ºæ•°å­—çš„æ•°é‡
            # cnt+1è¡¨ç¤ºæ¯ä¸ªæ•°å­—çš„é•¿åº¦æ•´ä½“è¡¨ç¤ºæ•°å­—çš„é•¿åº¦
            start = 9 * pow(10,cnt) * (cnt+1) 
            cnt += 1
        # Math.pow(10,cnt-1) è¡¨ç¤ºåŸºç¡€çš„æ•°å­—å¤§å°
        # Næ˜¯å‰©ä½™çš„æ•°ï¼Œé™¤ä»¥cntå†å‡å»1ä¹‹åå¾—åˆ°ç¬¬å‡ ä¸ªæ•°
        num_int = pow(10,cnt-1) + (math.ceil(N/cnt)-1)
        num_str = str(num_int)
        return int(num_str[(N-1) % cnt])
```



#### å‰‘æŒ‡ Offer 62. åœ†åœˆä¸­æœ€åå‰©ä¸‹çš„æ•°å­—

>   `çº¦ç‘Ÿå¤«ç¯`
>
>   ![image-20210720162410071](images/image-20210720162410071-1626769451628.png)
>
>   æ€è·¯ï¼šå®šä¹‰$F(n,m)$ä¸ºæœ‰nä¸ªæ•°ï¼Œéš”mä¸ªæ•°åˆ é™¤ä¸€ä¸ªï¼Œæœ€ç»ˆå‰©ä½™çš„é‚£ä¸ªæ•°çš„ä¸‹æ ‡ã€‚
>   $$
>   F(n,m)=[F(n-1,m)+m]\%nF(n,m)=[F(n-1,m)+m]\%n
>   $$

```python
class Solution:
    def lastRemaining(self, n: int, m: int) -> int:
        """
        æ“ä½œä¸€ï¼šå°†å½“å‰æˆ–è€…çš„ä¸‹æ ‡åŠ ä¸Šm
        æ“ä½œäºŒï¼šå–ä½™ï¼Œå¤åŸï¼Œä¸€ä¸ªåæ¨è¿‡ç¨‹
        """
        pos = 0
        for i in range(2,n+1):
            pos = (pos + m) % i # ä¸€ä¸ªåæ¨è¿‡ç¨‹
        return pos
```

æˆ–è€…é‡‡ç”¨æ¨¡æ‹Ÿæ³•ï¼š

```python
def solution(N,M):
    data = [i + 1 for i in range(N)]
    index = 0
    ans = []
    while data:
        index = (index + M - 1) % N
        ans.append(str(data[index]))
        data[index] = -1
        data.remove(-1)
        N -= 1
    return " ".join(ans)
```

#### å‰‘æŒ‡offer 66 æ„å»ºä¹˜ç§¯æ•°ç»„ 

æ€è·¯ï¼šæ•°ç»„ï¼Œä¸¤æ¬¡éå†ï¼Œç¬¬ä¸€æ¬¡éå†å®šä¹‰prodä¸ºé™¤äº†å½“å‰å…ƒç´ å¤–çš„å·¦è¾¹å…ƒç´ ä¹˜ç§¯ï¼Œç¬¬äºŒæ¬¡éå†prodä¸ºé™¤äº†å½“å‰å…ƒç´ å¤–çš„å³è¾¹å…ƒç´ ä¹˜ç§¯ã€‚

![image-20210428112752634](E:\git\typora\LeetCodeåˆ·é¢˜\images\image-20210428112752634.png)

```python
class Solution:
    def constructArr(self, a: List[int]) -> List[int]:
        m = len(a)
        if m == 0: return []

        b = a[:]
        prod = 1
        for i in range(m):
            a[i],prod = prod,prod*a[i]
        
        prod = 1
        for i in range(m-1,-1,-1):
            b[i],prod = prod*a[i],prod*b[i]

        return b
```



#### 457ç¯å½¢æ•°ç»„æ˜¯å¦å­˜åœ¨å¾ªç¯ ğŸ‰

>   ![image-20210726175235943](images/image-20210726175235943.png)

```python
class Solution:
    def circularArrayLoop(self, nums: List[int]) -> bool:
        n = len(nums)
        # xçš„ä¸‹ä¸€ä¸ªä½ç½®
        nxt = lambda x: (x + nums[x]) % n

        for i in range(n):
            if nums[i] == 0: continue
            slow = i
            fast = nxt(i)
            # å¿«æ…¢æŒ‡é’ˆ
            """ç¬¦å·ç›¸åŒä¿è¯æ˜¯åŒä¸€ä¸ªæ–¹å‘ç§»åŠ¨"""
            while nums[slow] * nums[fast] > 0 and nums[fast] * nums[nxt(fast)] > 0:
                """å¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œå¦‚æœå¿«æ…¢æŒ‡é’ˆç›¸ç­‰ï¼Œè¯´æ˜æœ‰ç¯"""
                if slow == fast:
                    """å¦‚æœæ˜¯è‡ªèº«ç¯ï¼Œé‚£ä¹ˆé€€å‡ºå¾ªç¯"""
                    if slow == nxt(slow):
                        break
                    else:
                        return True
                """æ›´æ–°çŠ¶æ€ï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥"""
                slow = nxt(slow)
                fast = nxt(nxt(fast))
            # è®¿é—®è¿‡çš„ç½®0
            """å¦‚æœä¸Šé¢é‚£è½®æ²¡æœ‰returnï¼Œè¯´æ˜ä¸Šé¢éå†è¿‡çš„å…ƒç´ éƒ½ä¸å¯èƒ½æˆç¯ï¼Œä¸ºé¿å…å†æ¬¡éå†é™·å…¥æ— æ•ˆæŸ¥æ‰¾ï¼Œæ•…å°†æŸ¥æ‰¾è¿‡çš„å…ƒç´ ç½®é›¶ï¼Œå†æ¬¡éå†æ—¶ç›´æ¥è·³è¿‡"""
            while nums[i]*(nums[nxt(i)]) > 0:
                """å…ˆæ‰¾åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ çš„index"""
                tmp = nxt(i)
                """å°†å½“å‰çš„å…ƒç´ ç½®é›¶"""
                nums[i] = 0
                """å‘ä¸‹èµ°ä¸€æ­¥"""
                i = tmp
        return False
```



#### 390 æ¶ˆé™¤æ¸¸æˆğŸ‰

>   ![image-20210725105206109](images/image-20210725105206109.png)
>
>   ç»´æŠ¤è¿™å‡ ä¸ªå˜é‡ï¼Œæ ¸å¿ƒä¸º**æ¨¡æ‹Ÿæ³•**
>
>   +   flagè¡¨ç¤ºå½“å‰æ•°ç»„çš„æ•°é‡æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°
>   +   resè¡¨ç¤ºå½“å‰ **æ•°ç»„ä¸­ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼ˆé‡ç‚¹ï¼‰**
>   +   stepè¡¨ç¤ºæ¯æ¬¡åˆ é™¤çš„é—´éš”æ•°é‡

```python
class Solution:
    def lastRemaining(self, n: int) -> int:
        remain = n
        flag = True
        res = 1
        step = 1

        while remain > 1:
            if flag or remain % 2 == 1:
                res += step
            flag = not flag
            step *= 2
            remain //= 2
        return res
```



## 4. æ¦‚ç‡ç›¸å…³

#### 382. é“¾è¡¨éšæœºèŠ‚ç‚¹

>   è“„æ°´æ± æŠ½æ ·ç®—æ³•
>
>   +   å½“`k=1`æ—¶ï¼Œä»¥ `1/i` çš„æ¦‚ç‡æŠ›å¼ƒæ‰ä»¥å‰çš„æ•°ï¼ˆä¹Ÿå°±æ˜¯ä¿ç•™å½“å‰çš„æ•°ï¼‰ï¼Œä»¥  `(i-1)/i` çš„æ¦‚ç‡ä¿ç•™ä»¥å‰çš„æ•°ã€‚
>
>   å¯¹äºç¬¬ä¸€ä¸ªæ•°ï¼š
>   $$
>   \begin{align}
>   p(n_1) &= 1 \\
>   p(n_2) &= 1 \times \frac{1}{2} \\
>   p(n_3) &= 1 \times \frac{1}{2} \times \frac{2}{3} \\
>   \cdots \\
>   p(n_N) &= 1 \times \frac{1}{2} \times \cdots \times \frac{N-1}{N} = \frac{1}{N}
>   \end{align}
>   $$
>   åŒç†å¯¹äºå…¶ä»–çš„æ•°ä¹Ÿæ˜¯è¿™æ ·
>
>   +   å½“`k>1`æ—¶ï¼Œé¦–å…ˆå¯¹äºå‰`k`ä¸ªå…ƒç´ éƒ½æ”¾åˆ°è“„æ°´æ± ä¸­ï¼Œå¯¹äºç¬¬`i (i>k)`ä¸ªæ•°è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º`k/i`ï¼Œä¸è¢«ç¬¬`i+1`ä¸ªå…ƒç´ æ›¿æ¢çš„æ¦‚ç‡
>
>       ä¸º $1-\frac{k}{j+1}\times \frac{1}{k}=\frac{j}{j+1}$ï¼Œåˆ™è¿è¡Œåˆ°ç¬¬`N`æ­¥æ—¶ï¼Œè¢«ä¿ç•™çš„æ¦‚ç‡=è¢«é€‰ä¸­çš„æ¦‚ç‡ * ä¸è¢«æ›¿æ¢çš„æ¦‚ç‡ï¼Œå³æ¡ä»¶æ¦‚ç‡çš„è¿ä¹˜ï¼Œ
>       $$
>       \frac{k}{j} \times \frac{j}{j+1} \times \frac{j+1}{j+2} \times \frac{N-1}{N} = \frac{k}{N}
>       $$

```python
class Solution:

    def __init__(self, head: ListNode):
        """
        @param head The linked list's head.
        Note that the head is guaranteed to be not null, so it contains at least one node.
        """
        self.head = head

    def getRandom(self) -> int:
        """
        Returns a random node's value.
        """
        p = self.head
        if not p: return -1
        
        # åˆå§‹åŒ–
        reserve = p.val
        count = 1

        # è“„æ°´æ± ç®—æ³•
        while p:
            prob = random.randint(1,count)
            if prob == count:
                reserve = p.val
            count += 1
            p = p.next
        
        return  
```



#### 384. æ‰“ä¹±æ•°ç»„ 

>   æ´—ç‰Œç®—æ³• shuffle
>
>   è¯¥ç®—æ³•çš„ç›®çš„æ˜¯åœ¨nä¸ªä¸åŒçš„éšæœºæ•°ä¸­éšæœºå–å‡ºä¸é‡å¤çš„mä¸ªæ•°ï¼Œé‚£ä¹ˆè¡¨ç¤ºçš„å«ä¹‰å°±æ˜¯åœ¨æ–°çš„æ•°ç»„ä¸­ï¼Œæ¯ä¸ªå…ƒç´ åº”è¯¥æ˜¯**è¢«ç­‰æ¦‚ç‡é€‰å–**çš„ã€‚
>
>   å¼€å§‹æ•°ç»„ä¸­æœ‰äº”ä¸ªå…ƒç´ ï¼›
>   åœ¨å‰äº”ä¸ªæ•°ä¸­éšæœºé€‰ä¸€ä¸ªæ•°ä¸ç¬¬äº”ä¸ªæ•°è¿›è¡Œäº¤æ¢ï¼Œæ¯ä¸ªæ•°éƒ½æœ‰äº”åˆ†ä¹‹ä¸€çš„æ¦‚ç‡è¢«äº¤æ¢åˆ°æœ€åä¸€ä¸ªä½ç½®ï¼›
>   åœ¨å‰å››ä¸ªæ•°ä¸­éšæœºé€‰ä¸€ä¸ªæ•°ä¸ç¬¬å››ä¸ªæ•°è¿›è¡Œäº¤æ¢ï¼Œæ¯ä¸ªæ•°éƒ½æœ‰äº”åˆ†ä¹‹ä¸€çš„æ¦‚ç‡è¢«äº¤æ¢åˆ°ç¬¬å››ä¸ªä½ç½®ï¼›
>   åœ¨å‰ä¸‰ä¸ªæ•°ä¸­éšæœºé€‰ä¸€ä¸ªæ•°ä¸ç¬¬ä¸‰ä¸ªæ•°è¿›è¡Œäº¤æ¢ï¼Œæ¯ä¸ªæ•°éƒ½æœ‰äº”åˆ†ä¹‹ä¸€çš„æ¦‚ç‡è¢«äº¤æ¢åˆ°ç¬¬ä¸‰ä¸ªä½ç½®ï¼›
>
>   <img src="images/1616380923-YvHlbL-53BF82B993210EA6F26B63EC7BDBFB04.png" alt="53BF82B993210EA6F26B63EC7BDBFB04.png" style="zoom: 50%;" />

```python
class Solution:

    def __init__(self, nums: List[int]):
        self.nums = nums
        self.record = nums[:]


    def reset(self) -> List[int]:
        """
        Resets the array to its original configuration and return it.
        """
        self.nums = self.record[:]
        return self.nums

    def shuffle(self) -> List[int]:
        """
        Returns a random shuffling of the array.
        """
        n = len(self.nums)
        for i in range(n):
            index = random.randint(i,n-1) # å½“iç­‰äº1æ—¶ï¼Œä»£è¡¨ä»[0,n-1]è¿™äº›å…ƒç´ ä¸­ä»»æ„é€‰å–ä¸€ä¸ªï¼ŒåŒ…æ‹¬å½“å‰æ•°
            self.nums[i],self.nums[index] \
                = self.nums[index],self.nums[i]
        return self.nums
```



#### 398. éšæœºæ•°ç´¢å¼•

>   è“„æ°´æ± æŠ½æ ·ç®—æ³•



>   åˆ©ç”¨å­—å…¸è¿›è¡Œå¤„ç† + éšæœºå‡½æ•°åº“è¿›è¡Œå¤„ç†

```python
class Solution:

    def __init__(self, nums: List[int]):
        
        self.nums_dict = collections.defaultdict(list)
        for i in range(len(nums)):
            self.nums_dict[nums[i]].append(i)

    def pick(self, target: int) -> int:
        size = len(self.nums_dict[target])
        return self.nums_dict[target][random.randint(0,size-1)]
```





#### 470. ç”¨ Rand7() å®ç° Rand10()

>   $$
>   [randX()-1]*Y + randY()
>   $$
>
>   å¯ä»¥ç”ŸæˆèŒƒå›´åœ¨`[1,x*y]`ä¹‹é—´å‡åŒ€åˆ†å¸ƒçš„æ•°æ®ã€‚

```python
class Solution:
    def rand10(self):
        """
        :rtype: int
        res = (rand7()-1)*7 + rand7()
        rand7() ç”Ÿæˆ [1,7]çš„éšæœºæ•°
        rand7()-1 ç”Ÿæˆ [0,6]çš„éšæœºæ•°
        (rand7()-1)*7 ç”Ÿæˆ {0,7,14,21,28,35,42} çš„éšæœºæ•°
        (rand7()-1)*7 + rand7() ç”Ÿæˆ [1,49] çš„éšæœºæ•°
        ç„¶ååˆ©ç”¨æ‹’ç»å‡è®¾æ¥å®Œæˆæœ€åçš„ç»“æœ
        """
        while True:
            res = (rand7()-1)*7 + rand7() # ç”Ÿæˆ[1,49]çš„å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°
            if res <= 40:
                return res % 10 + 1
```



#### è…¾è®¯&ç¾å›¢é¢è¯•é¢˜ï¼Œåˆ©ç”¨`p,1-p`ç”Ÿæˆç­‰æ¦‚ç‡å‘ç”Ÿå™¨

åˆ¶ä½œ 1 2 å‘ç”Ÿæ¦‚ç‡éƒ½æ˜¯ `1/2` çš„å‘ç”Ÿå™¨ï¼Œè¿ç»­å‘ç”Ÿ2æ¬¡ï¼Œåˆ™å‘ç”Ÿ`00,11`çš„æ¦‚ç‡ä¸º`p*p,(1-p)(1-p)`,å‘ç”Ÿ`10,01`çš„æ¦‚ç‡éƒ½ä¸º`p(1-p)`,åœ¨å‘ç”Ÿ10æ—¶è¿”å›1ï¼Œå‘ç”Ÿ01æ—¶è¿”å›2ï¼Œåˆ™å‘ç”Ÿ1ï¼Œ2çš„æ¦‚ç‡ç›¸ç­‰ã€‚



## 4. æ•°æ®è½¬æ¢ç³»åˆ—

#### çŠ¶æ€æœº

ä¼˜å…ˆçŠ¶æ€è‡ªåŠ¨æœºç”±ï¼š

+   ä¸€ç»„çŠ¶æ€
+   ä¸€ä¸ªåˆå§‹çŠ¶æ€
+   è¾“å…¥
+   æ ¹æ®è¾“å…¥ä»¥åŠç°æœ‰çŠ¶æ€è½¬æ¢ä¸ºä¸‹ä¸€ä¸ªçŠ¶æ€çš„è½¬ç§»å‡½æ•°

####  å‰‘æŒ‡ Offer 20. è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²

æ€è·¯ï¼šä¸»ç«™ï¼Œ[65. æœ‰æ•ˆæ•°å­—](https://leetcode-cn.com/problems/valid-number/)

+   å…ˆå®šä¹‰çŠ¶æ€ï¼Œç„¶åç”»å‡ºçŠ¶æ€è½¬ç§»å›¾ï¼Œæœ€åç¼–å†™ä»£ç 

```python
class Solution:
    def isNumber(self, s: str) -> bool:
        """
        0: å¼€å§‹å‰çš„ç©ºæ ¼ï¼Œ"  12.3", "  .3", "  -4"
        1: å¹‚ç¬¦å·å‰çš„æ­£è´Ÿå·ï¼š" -34e3"," 34e3"
            2: å°æ•°ç‚¹å‰çš„æ•°å­—ï¼š"  -[43]."
            3: å°æ•°ç‚¹åçš„æ•°å­—: "  -43.[324]"
        4: å½“å°æ•°ç‚¹å‰ä¸ºç©ºæ ¼æ—¶çš„çŠ¶æ€ï¼š"  ."
        5: é‡åˆ°å¹‚ç¬¦å·ï¼š" +12[e]"
        6: å¹‚ç¬¦å·åçš„æ­£è´Ÿå·: " +12e[+]"
            7: å¹‚ç¬¦å·åçš„æ•°å­—: " +12e[342]"
            8: ç»“å°¾çš„ç©ºæ ¼: " +12e342[  ]"
        åˆæ³•çš„ç»“æŸçŠ¶æ€ä¹‹å2ï¼Œ3ï¼Œ7ï¼Œ8
        """
        transfer = {
            0: {"blank":0,"sign":1,"digit":2,"dot":4},
            1: {"digit":2,"dot":4},
            2: {"digit":2,"dot":3,"blank":8,"e":5},
            3: {"digit":3,"blank":8,"e":5},
            4: {"digit":3},
            5: {"sign":6,"digit":7},
            6: {"digit":7},
            7: {"digit":7,"blank":8},
            8: {"blank":8}
        }

        state = 0
        for c in s:
            if c.isdigit(): action = "digit"
            elif c == " ": action = "blank"
            elif c in "eE": action = "e"
            elif c in "+-": action = "sign"
            elif c == ".": action = "dot"
            else: return False

            state = transfer[state].get(action,None)
            if not state: return False
        
        return state in (2,3,7,8)
```





#### å‰‘æŒ‡ Offer 67. æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°

æ€è·¯ï¼šä¸ä¸»ç«™çš„ç¬¬å…«é¢˜ç›¸åŒã€‚

```python
class Solution:
    def strToInt(self, str: str) -> int:
        # å¤„ç†ç©ºæ ¼
        MAX_VAL = 2**31-1
        MIN_VAL = -2**31
        i= 0
        s = str
        n = len(s)
        num = 0
        flag = False # flag è¡¨ç¤ºçš„å«ä¹‰æ˜¯æ˜¯å¦é‡åˆ°+æˆ–è€…-å·ï¼Œä»è€Œè¿›å…¥æ•°å­—è¿ç®—çŠ¶æ€        
        signed = 1 # æ­£è´Ÿ

        while i < n:
            if s[i] == " ":
                if flag: break
            elif s[i].isdigit():
                num = 0
                while i < n and s[i].isdigit():
                    num = num*10+int(s[i])
                    if num >= MAX_VAL+1:
                        num = MAX_VAL+1
                        break
                    i += 1
                num *= signed
                num = min(num,MAX_VAL)
                num = max(num,MIN_VAL)
                break
            elif s[i] == "+" or s[i] == "-":
                if flag: break # é‡å¤é‡åˆ°flag,é€€å‡º
                signed = 1 if s[i] == "+" else -1
                flag = True
            else:
                break
            i += 1
        
        return num
```

é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ç”¨çŠ¶æ€è½¬æ¢æœºåšï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ï¼Œå½“è¯»å–åˆ°actionçš„æ—¶å€™ï¼Œä¸èƒ½ç«‹å³å°†æ•°æ®è®¡ç®—åˆ°ansä¸Šï¼Œå› ä¸ºå½“å‰çš„actionå¯èƒ½ä¸åˆæ³•ã€‚

![image-20210515155513370](images/image-20210515155513370.png)

```python
class Solution:
    def myAtoi(self, s: str) -> int:
        MAX_VAL = 2147483647
        MIN_VAL = -2147483648

        def check(ans):
            if ans >= MIN_VAL and ans <= MAX_VAL:
                return False
            return True

        trasnfer = {
            0: {"sign":1,"blank":0,"digit":2},
            1: {"digit":2},
            2: {"digit":2,"blank":3},
            3: {"blank":3}
        }
        sign_dict = {"+":1,"-":-1}

        state = 0
        ans = 0
        sign = 1
        for c in s:
            if c.isdigit():
                action = "digit"
            elif c == " ":
                action = "blank"
            elif c in "+-":
                action = "sign"
            else:
                break
            state = trasnfer[state].get(action,None)
            if state is None: break
            elif action == "digit":
                ans = ans * 10 + int(c)
                if check(sign*ans):
                    return MAX_VAL if sign == 1 else MIN_VAL
            elif action == "sign":
                sign = sign_dict[c]
        return sign*ans
```





#### 12. æ•´æ•°è½¬ç½—é©¬æ•°å­—

æ€è·¯ï¼šè´ªå¿ƒç®—æ³•ï¼Œæ¯æ¬¡å°½å¯èƒ½ç”¨è¾ƒå¤§çš„æ•°è¿›è¡Œè¡¨ç¤ºã€‚

```python
# æ‰€æœ‰å¯èƒ½çš„è¿›åˆ¶ï¼š[1000,900,500,400,100,90,50,40,10,9,5,4,1]
# æ¯”å¦‚å¯¹äº 2984ï¼Œæ‹†åˆ†æˆï¼š2*1000 + 1*900 + 1*50 + 3*10 + 1*4
class Solution:
    def intToRoman(self, num: int) -> str:
        mark_one = {
            1:"I",
            10:"X",
            100:"C",
            1000:"M",
            5:"V",
            50:"L",
            500:"D",
            4: "IV",
            9: "IX",
            40: "XL",
            90: "XC",
            400: "CD",
            900: "CM"
        }
        lists = [1000,900,500,400,100,90,50,40,10,9,5,4,1]
        ans = ""
        idx = 0
        while idx < len(lists):
            count = num // lists[idx]
            if count != 0:
                ans += mark_one[lists[idx]]*count
            num = num % lists[idx]
            idx += 1
        return ans
```

#### 13 ç½—é©¬æ•°å­—è½¬æ•´æ•°

æ€è·¯ï¼šå’Œ12é¢˜ç›®åç€æ¥

```python
class Solution:
    def romanToInt(self, s: str) -> int:
        mark_one = {
            "I":1,
            "X":10,
            "C":100,
            "M":1000,
            "V":5,
            "L":50,
            "D":500,
            "a":4,
            "b":9,
            "c":40,
            "d":90,
            "e":400,
            "f":900
        }
        s = s.replace("IV","a")
        s = s.replace("IX","b")
        s = s.replace("XL","c")
        s = s.replace("XC","d")
        s = s.replace("CD","e")
        s = s.replace("CM","f")

        idx = len(s)-1
        ans = 0
        for val in s:
            ans += mark_one[val]
        return ans
```



#### 273 æ•´æ•°è½¬è‹±æ–‡ ğŸ‰

æ€è·¯ï¼šåˆ†æ²»æ³•çš„åŸç†ï¼Œå°†æ•°æ®æŒ‰ç…§20ï¼Œ100ï¼Œ1000ï¼Œ1000~1000,000ï¼Œ1,000,000 ~ 1,000,000,000

```python
class Solution:
    def numberToWords(self, num: int) -> str:
        digits_20 = "One Two Three Four Five Six Seven Eight Nine Ten Eleven Twelve Thirteen Fourteen Fifteen Sixteen Seventeen Eighteen Nineteen".split(" ") # å°äº20çš„æ•°æ®
        digits_100 = "Twenty Thirty Forty Fifty Sixty Seventy Eighty Ninety".split(" ") # å°äº100çš„æ•°æ®
        digits_up = "Thousand Million Billion".split(" ")

        def helper(num,index):
            if num == 0: return []
            if num < 20:
                return [digits_20[num-1]]
            elif num < 100:
                return [digits_100[num//10-2]] +  helper(num%10,index)
            elif num < 1000:
                return [digits_20[num//100-1]] + ["Hundred"] + helper(num%100,index)
            else:
                if (num // 1000 < 1000)  or (num // 1000 % 1000 != 0):
                    # å¤„ç†ä¸¤ç±»æ•°æ®
                    # 1. å°äºä¸€ç™¾ä¸‡çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®éƒ½è¡¨ç¤ºä½ `xxx Thousand`ï¼ŒThousandèŠ‚æƒå¿…ç„¶ä¿ç•™
                    #    æ¯”å¦‚ï¼š45,400 --> Forty Five Thousand Four Hundred
                    # 2. å¤§äºä¸€ç™¾ä¸‡çš„æ•°æ®ï¼Œä½†æ˜¯åœ¨ç™¾ä¸‡ä½æƒåˆ°åƒä½èŠ‚æƒä¸­ï¼Œå­˜åœ¨éé›¶æ•°å­—ï¼Œè¿™ç±»æ•°æ®è¡¨ç¤ºä¸ºï¼š`xxx Million xxx Thousand`
                    #    æ¯”å¦‚ï¼š1,001,400
                    return helper(num//1000,index+1) + [digits_up[index]] + helper(num % 1000,index)
                else:
                    # å¤„ç†ä¸€ç±»æ•°æ®
                    # 1. å¤§äºä¸€ç™¾ä¸‡çš„æ•°æ®ï¼Œå¹¶ä¸”åœ¨ç™¾ä¸‡ä½æƒåˆ°åƒä½èŠ‚æƒä¸­ï¼Œä¸å­˜åœ¨éé›¶æ•°å­—
                    #     æ¯”å¦‚1,000,400 --> One Millon
                    return helper(num//1000,index+1) + helper(num % 1000,index)
        if num == 0: return "Zero"
        data = helper(num,0)
        return " ".join(data)
```



#### 224. åŸºæœ¬è®¡ç®—å™¨

æ€è·¯ï¼šå•æ ˆè§£æ³•

```python
class Solution:
    def calculate(self, s: str) -> int:
        """
        @Desc è¾¹è¿è¡Œè¾¹è®¡ç®—çš„æ–¹æ³•
        resç”¨æ¥å­˜å‚¨å½“å‰è¿ç®—è¡¨è¾¾å¼çš„ç»“æœã€‚
        å¦‚æœå‡ºç°å·¦æ‹¬å·ï¼Œå½“å‰reså’Œsignç»“æœå…¥æ ˆï¼Œreså’Œsigné‡æ–°åˆå§‹åŒ–ï¼Œç”¨äºé‡æ–°è®¡ç®—ã€‚
        å¦‚æœå‡ºç°å³æ‹¬å·ï¼Œå½“å‰å°†å½“å‰reså’Œæ ˆä¸­çš„resè®¡ç®—ï¼Œå¾—åˆ°æ–°çš„ç»“æœã€‚
        å¦‚æœé‡åˆ°ç¬¦å·ï¼Œå˜æ¢å½“å‰sign
        é‡åˆ°æ•°å­—ï¼Œç´¯ç§¯ï¼Œå¹¶è¿›è¡Œè®¡ç®—ã€‚
        """
        i = 0
        res = 0
        sign = 1
        stack = [(res,sign)]

        while i < len(s):
            if s[i].isdigit():
                num = 0
                while i < len(s) and s[i].isdigit():
                    num = 10*num + int(s[i])
                    i += 1
                res = res + sign*num # è¾¹è¿è¡Œï¼Œè¾¹è®¡ç®—
                i -= 1
            elif s[i] == "(":
                # é‡åˆ°å·¦æ‹¬å·ï¼Œreså’Œsignç»“æœå…¥æ ˆï¼Œreså’Œsigné‡æ–°åˆå§‹åŒ–
                stack.append((res,sign))
                res = 0
                sign = 1
            elif s[i] == ")":
                # é‡åˆ°å³æ‹¬å·ï¼Œå°†æ ˆä¸­reså’Œå½“å‰resè®¡ç®—
                old_res,old_sign = stack.pop()
                res = old_res + old_sign*res
            elif s[i] == "+":
                sign = 1
            elif s[i] == "-":
                sign = -1
            i += 1
        return res

```



#### 227. åŸºæœ¬è®¡ç®—å™¨ II

>   é€šç”¨è§£æ³•ï¼šåŒæ ˆæ³•

```python
class Solution:
    def calculate(self, s: str) -> int:
        def convert_to_suffix_exp(data):
            """
            å°†è¡¨è¾¾å¼ç”±ä¸­ç¼€è¡¨è¾¾å¼è½¬æ¢æˆåç¼€è¡¨è¾¾å¼
            """
            if data[0] in "+-": data = "0" + data
            data = data.replace("(-","(0-")
            data = data.replace("(+","(0+")
            print(data)

            
            expression = {
                "+": lambda a,b: a+b,
                "-": lambda a,b: a-b,
                "*": lambda a,b: a*b,
                "/": lambda a,b: a//b,
            }            
            priority = {"+":1,"-":1,"*":2,"/":2,"(":0,")":3}
            op_set = {"+","-","(",")","*","/"} # æ“ä½œç¬¦é›†åˆ
            op_stack = [] # è¿ç®—ç¬¦æ ˆ
            exp_stack = [] # è¡¨è¾¾å¼æ ˆ
            i = 0
            while i < len(data):
                if data[i] == " ":
                    pass
                elif data[i] in op_set:
                    if data[i] == "(": # å·¦è¾¹è‡ªåŠ¨åŠ å…¥æ“ä½œç¬¦æ ˆ
                        op_stack.append(data[i])
                    elif data[i] == ")":
                        while op_stack and op_stack[-1] != "(":
                            b = exp_stack.pop()
                            a = exp_stack.pop()
                            exp_stack.append(expression[op_stack.pop()](a,b))
                        op_stack.pop() # å¼¹å‡ºå·¦æ‹¬å·
                    else:
                        # é’ˆå¯¹ 7*8+9ï¼Œ
                        # åœ¨é‡åˆ°+æ—¶å€™
                        # åœ¨æ“ä½œç¬¦æ ˆä¸­ï¼š[*]
                        # åœ¨è¡¨è¾¾å¼æ ˆä¸­ï¼Œ[7,8]
                        # è¿™æ—¶å€™ä¼˜å…ˆå°†: [*]å‡ºæ ˆï¼ŒåŠ å…¥åˆ°è¡¨è¾¾å¼æ ˆä¸­ï¼š[7,8,*],æ“ä½œç¬¦æ ˆï¼š[+]
                        while op_stack and priority[op_stack[-1]] >= priority[data[i]]:
                            b = exp_stack.pop()
                            a = exp_stack.pop()
                            exp_stack.append(expression[op_stack.pop()](a,b))
                        op_stack.append(data[i])
                elif data[i].isdigit():
                    num = 0
                    while i < len(data) and data[i].isdigit():
                        num = num*10 + int(data[i])
                        i += 1
                    i -= 1
                    exp_stack.append(num)
                i += 1
            while op_stack: 
                b = exp_stack.pop()
                a = exp_stack.pop()
                exp_stack.append(expression[op_stack.pop()](a,b))
            return exp_stack

        return convert_to_suffix_exp(s)[0]
s = Solution()
s.calculate("12*899+(12-31)")
```



[150. é€†æ³¢å…°è¡¨è¾¾å¼æ±‚å€¼](https://leetcode-cn.com/problems/evaluate-reverse-polish-notation/)



## 5. åˆç­‰æ•°å­¦ç³»åˆ—

#### æ±‚å’Œå…¬å¼

+   ç­‰å·®æ•°åˆ—æ±‚å’Œ

$$
s = \frac{n*(a_1+a_n)}{2}
$$

#### æ¢åº•å…¬å¼

$$
\log_a b = \frac{\log_c b}{\log_c a}
$$

#### å¹³æ–¹å’Œå…¬å¼

![formula](images/u=3513762642,3893587575&fm=58)

#### 48 æ—‹è½¬å›¾åƒ `æ‰¾è§„å¾‹` `æ•°å­¦é¢˜`





#### 49 å­—æ¯å¼‚æˆ–è¯åˆ†ç»„ `è´¨æ•°`





#### 279. å®Œå…¨å¹³æ–¹æ•°

>   æ€è·¯ï¼šåŠ¨æ€è§„åˆ’ æˆ– æ•°å­¦å…¬ç†





## 7 æ•°å­¦çŸ¥è¯†

#### 7.1 å¡ç‰¹å…°æ•°

[ã€å‚è€ƒèµ„æ–™-TODOã€‘](https://leetcode-cn.com/circle/article/lWYCzv/)

>   **é¢˜ç›®æè¿°**
>
>   n ä¸ªå…ƒç´ è¿›æ ˆåºåˆ—ä¸ºï¼š`1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ...ï¼Œn`ï¼Œåˆ™æœ‰å¤šå°‘ç§å‡ºæ ˆåºåˆ—

+   å¸¸è§„æ€è·¯

    æˆ‘ä»¬å‡å®š`ç¬¬ä¸€ä¸ªå‡ºæ ˆçš„åºæ•°`æ˜¯ `k`ï¼Œç¬¬ä¸€ä¸ªå‡ºæ ˆçš„åºæ•°`k` å°† `1~n` çš„åºåˆ—åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ `1~k-1`ï¼Œåºåˆ—ä¸ªæ•°ä¸º`k-1`ï¼›å¦å¤–ä¸€éƒ¨åˆ†æ˜¯ `k+1~n`ï¼Œæ•°é‡ä¸º `n-k`ã€‚æ‰€æœ‰é€‰æ‹© `k`ä½œä¸ºç¬¬ä¸€ä¸ªå‡ºæ ˆçš„å‡ºæ ˆåºåˆ—ä¸ªæ•°ä¸º

$$
G(k) = G(k-1)*G(n-k)
$$

è€Œ `k` å¯ä»¥é€‰æ‹©çš„èŒƒå›´æ˜¯`1~n`ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»“æœä¸ºï¼š
$$
H(n) = G(0)*G(n-1)+\cdots+G(n-1)*G(0) = C^n_{2n}-C^{n+1}_{2n}=\frac{C_{2n}^{n}}{n+1}
$$

+   éå¸¸è§„æ€è·¯

    ä¸€ä¸ªå…ƒç´ å…¥æ ˆï¼Œæˆ‘ä»¬æ ‡å¿—ä¸º `1` ï¼›ä¸€ä¸ªå…ƒç´ å‡ºæ ˆï¼Œæˆ‘ä»¬æ ‡å¿—ä½ `-1`ï¼›é‚£ä¹ˆæ•´ä½“åº”è¯¥æœ‰ `2n` ä¸ªå…ƒç´ ã€‚

    é¦–å…ˆï¼Œä» `2n` ä¸ªå…ƒç´ ä¸­é€‰å– `n` ä¸ªå…ƒç´ å¡«å…¥ `1` , å‰©ä½™çš„é»˜è®¤å¡«å…¥ `-1`ï¼›è€Œä¸åˆè¦æ±‚çš„ `2n` ä½æ•°ä¸ `n+1` ä¸ª `0` ï¼Œ`n-1` ä¸ª `1` ç»„æˆçš„æ’åˆ—ä¸€ä¸€å¯¹åº”ã€‚æ‰€ä»¥åˆæ³•çš„æ’åˆ—æ•°é‡ä¸ºï¼š
    $$
    C^n_{2n}-C^{n+1}_{2n}=\frac{C_{2n}^{n}}{n+1}
    $$

#### 7.2 æ¨è¾‰ä¸‰è§’

![image-20210826155917446](images/image-20210826155917446.png)

æ¨è¾‰ä¸‰è§’çš„å¿«é€Ÿè®¡ç®—å…¬å¼ï¼š
$$
G(n,k) = \C_{n}^{k}=\frac{n!}{k!(n-k)!}
$$
![æ¨è¾‰ä¸‰è§’ç»„åˆ](images/pascals-triangle-n-choose-k.gif)

## äº†è§£å³å¯

#### 287 å¯»æ‰¾é‡å¤æ•°



#### 689. ä¸‰ä¸ªæ— é‡å å­æ•°ç»„çš„æœ€å¤§å’Œ ğŸ‰

>   ![image-20210725113906314](images/image-20210725113906314.png)





#### 866 å›æ–‡ç´ æ•°



## èµ„æ–™

[1] https://blog.csdn.net/weixin_42426714/article/details/109591964

[2] https://www.cnblogs.com/Komnenos/p/11968614.html

