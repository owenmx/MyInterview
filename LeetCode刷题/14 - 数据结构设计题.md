## æ“ä½œç³»ç»Ÿ

#### 460 LFU ç¼“å­˜ ðŸ‰

>   ![ ](https://pic.leetcode-cn.com/f9cbf292271ab715f5dab1f08bb0bab834fae7d24d26cc675ee0cc4fdb2f18c7-6.gif)

éœ€è¦ä¸¤ä¸ªHashè¡¨ä¸€ä¸ªæ˜¯`key-value` å“ˆå¸Œè¡¨ï¼ˆç”¨æ¥å­˜å‚¨`k-v`å€¼ï¼‰ï¼Œä¸€ä¸ªæ˜¯é¢‘çŽ‡å“ˆå¸Œè¡¨ç”¨æ¥å­˜å‚¨`Node`åŒå‘é“¾è¡¨ã€‚

```python
class Node(object):
    """
    åŒé“¾è¡¨ä¸­çš„é“¾è¡¨èŠ‚ç‚¹å¯¹è±¡
    """
    def __init__(self,key=None,value=None,freq=0):
        """
        Args:
            key:å¯¹åº”è¾“å…¥çš„key
            value:å¯¹åº”è¾“å…¥çš„value
            freq:è¢«è®¿é—®çš„é¢‘çŽ‡
            pre:æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
            next:æŒ‡å‘åŽä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
        """
        self.key = key
        self.value = value
        self.freq = freq
        self.pre = None
        self.next = None
        
class LinkedList(object):
    """
    è‡ªå®šä¹‰çš„åŒå‘é“¾è¡¨
    """
    def __init__(self):
        """
        Args:
            __head:åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹
            __tail:åŒå‘é“¾è¡¨çš„å°¾èŠ‚ç‚¹
        """
        self.__head = Node()
        self.__tail = Node()
        self.__head.next = self.__tail
        self.__tail.pre = self.__head
        
    def insertFirst(self,node):
        """
        å°†æŒ‡å®šçš„èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨çš„ç¬¬ä¸€ä¸ªä½ç½® 
        Args:
            node:å°†è¦æ’å…¥çš„èŠ‚ç‚¹    
        """
        node.next = self.__head.next
        self.__head.next.pre = node
        self.__head.next = node
        node.pre = self.__head
        
    def delete(self,node):
        """
        ä»Žé“¾è¡¨ä¸­åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹ 
        Args:
            node:å°†è¦åˆ é™¤çš„èŠ‚ç‚¹ 
        """
        if self.__head.next==self.__tail:
            return
        node.pre.next = node.next
        node.next.pre = node.pre
        node.next = None
        node.pre = None
        
    def getLast(self):
        """
        ä»Žé“¾è¡¨ä¸­èŽ·å–æœ€åŽä¸€ä¸ªèŠ‚ç‚¹
        Returns:
            åŒå‘é“¾è¡¨ä¸­çš„æœ€åŽä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æžœæ˜¯ç©ºé“¾è¡¨åˆ™è¿”å›žNone
        """        
        if self.__head.next==self.__tail:
            return None
        return self.__tail.pre
        
    def isEmpty(self):
        """
        åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©ºï¼Œé™¤äº†headå’Œtailæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹å³ä¸ºç©ºé“¾è¡¨
        Returns:
            é“¾è¡¨ä¸ç©ºè¿”å›žTrueï¼Œå¦åˆ™è¿”å›žFalse
        """  
        return self.__head.next==self.__tail

class LFUCache(object):
    """
    è‡ªå®šä¹‰çš„LFUç¼“å­˜
    """
    def __init__(self, capacity):
        """
        Args:
            __capacity:ç¼“å­˜çš„æœ€å¤§å®¹é‡
            __keyMap: key->Node è¿™ç§ç»“æž„çš„å­—å…¸
            __freqMap:freq->LinkedList è¿™ç§ç»“æž„çš„å­—å…¸
            __minFreq:è®°å½•ç¼“å­˜ä¸­æœ€ä½Žé¢‘çŽ‡
        """
        self.__capacity = capacity
        self.__keyMap = dict()
        self.__freqMap = dict()
        self.__minFreq = 0
        

    def get(self, key):
        """
        èŽ·å–ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æžœkeyä¸å­˜åœ¨åˆ™è¿”å›ž-1ï¼Œå¦åˆ™è¿”å›žå¯¹åº”çš„value
        åŒæ—¶æ›´æ–°è¢«è®¿é—®å…ƒç´ çš„é¢‘çŽ‡
        Args:
            key:è¦æŸ¥æ‰¾çš„å…³é”®å­—
        Returns:
            å¦‚æžœæ²¡æ‰¾åˆ°åˆ™è¿”å›ž-1ï¼Œå¦åˆ™è¿”å›žå¯¹åº”çš„value
        """
        if key not in self.__keyMap:
            return -1
        node = self.__keyMap[key]
        self.__increment(node)
        return node.value

    def put(self, key, value):
        """
        æ’å…¥æŒ‡å®šçš„keyå’Œvalueï¼Œå¦‚æžœkeyå­˜åœ¨åˆ™æ›´æ–°valueï¼ŒåŒæ—¶æ›´æ–°é¢‘çŽ‡
        å¦‚æžœkeyä¸å­˜å¹¶ä¸”ç¼“å­˜æ»¡äº†ï¼Œåˆ™åˆ é™¤é¢‘çŽ‡æœ€ä½Žçš„å…ƒç´ ï¼Œå¹¶æ’å…¥æ–°å…ƒç´ 
        å¦åˆ™ï¼Œç›´æŽ¥æ’å…¥æ–°å…ƒç´ 
        Args:
            key:è¦æ’å…¥çš„å…³é”®å­—
            value:è¦æ’å…¥çš„å€¼
        """
        if key in self.__keyMap:
            node = self.__keyMap[key]
            node.value = value
            self.__increment(node)
        else:
            if self.__capacity==0:
                return
            if len(self.__keyMap)==self.__capacity:
                self.__removeMinFreqElement()
            node = Node(key,value,1)
            self.__increment(node,True)
            self.__keyMap[key] = node
        
    def __increment(self,node,is_new_node=False):
        """
        æ›´æ–°èŠ‚ç‚¹çš„è®¿é—®é¢‘çŽ‡
        Args:
            node:è¦æ›´æ–°çš„èŠ‚ç‚¹
            is_new_node:æ˜¯å¦æ˜¯æ–°èŠ‚ç‚¹ï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹å’Œéžæ–°æ’å…¥èŠ‚ç‚¹æ›´æ–°é€»è¾‘ä¸åŒ
        """
        if is_new_node:
            self.__minFreq = 1
            self.__setDefaultLinkedList(node)
        else:
            self.__deleteNode(node)
            node.freq += 1
            self.__setDefaultLinkedList(node)
            if self.__minFreq not in self.__freqMap:
                self.__minFreq += 1
    
    def __setDefaultLinkedList(self,node):
        """
        æ ¹æ®èŠ‚ç‚¹çš„é¢‘çŽ‡ï¼Œæ’å…¥åˆ°å¯¹åº”çš„LinkedListä¸­ï¼Œå¦‚æžœLinkedListä¸å­˜åœ¨åˆ™åˆ›å»º
        Args:
            node:å°†è¦æ’å…¥åˆ°LinkedListçš„èŠ‚ç‚¹
        """
        if node.freq not in self.__freqMap:
            self.__freqMap[node.freq] = LinkedList()
        linkedList = self.__freqMap[node.freq]
        linkedList.insertFirst(node)
        
    def __deleteNode(self,node):
        """
        åˆ é™¤æŒ‡å®šçš„èŠ‚ç‚¹ï¼Œå¦‚æžœèŠ‚ç‚¹åˆ é™¤åŽï¼Œå¯¹åº”çš„åŒé“¾è¡¨ä¸ºç©ºï¼Œåˆ™ä»Ž__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
        Args:
            node:å°†è¦åˆ é™¤çš„èŠ‚ç‚¹
        """
        if node.freq not in self.__freqMap:
            return
        linkedList = self.__freqMap[node.freq]
        freq = node.freq
        linkedList.delete(node)
        if linkedList.isEmpty():
            del self.__freqMap[freq]
        
    def __removeMinFreqElement(self):
        """
        åˆ é™¤é¢‘çŽ‡æœ€ä½Žçš„å…ƒç´ ï¼Œä»Ž__freqMapå’Œ__keyMapä¸­éƒ½è¦åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æžœèŠ‚ç‚¹åˆ é™¤åŽå¯¹åº”çš„é“¾è¡¨ä¸ºç©ºï¼Œåˆ™è¦ä»Ž__freqMapä¸­åˆ é™¤è¿™ä¸ªé“¾è¡¨
        """
        linkedList = self.__freqMap[self.__minFreq]
        node = linkedList.getLast()
        linkedList.delete(node)
        del self.__keyMap[node.key]
        if linkedList.isEmpty():
            del self.__freqMap[node.freq]
```









## äºŒå‰æ ‘

#### äºŒå‰å¹³è¡¡æœç´¢æ ‘ï¼ˆAVL ï¼‰

>   åŸºæœ¬å®šä¹‰

åŒæ ·æ˜¯äºŒåˆ†æœç´¢æ ‘ï¼Œå³è¾¹çš„äºŒå‰æ ‘è¾ƒçŸ®ï¼Œåœ¨è¿›ç»“ç‚¹æŸ¥æ‰¾ã€æ·»åŠ ã€åˆ é™¤æ“ä½œæ—¶ï¼Œéƒ½æ¯”å·¦è¾¹çš„äºŒå‰æœç´¢æ ‘è¦å¿«ã€‚

![image-20210413164752821](..\LeetCodeåˆ·é¢˜\images\image-20210413164752821.png)

æ¯”è¾ƒçŸ®çš„äºŒå‰æ ‘æ˜¯æˆ‘ä»¬æ‰€å–œæ¬¢çš„ï¼Œé«˜çš„äºŒå‰æ ‘æ˜¯æ€§èƒ½è¾ƒå·®çš„ï¼Œæœ€å·®æƒ…å†µä¸‹ï¼Œé€€åŒ–æˆé“¾è¡¨ã€‚

>   BSTçš„ç­‰ä»·æ€§

ä¸‹å›¾çš„äº”ç§äºŒå‰æœç´¢æ ‘éƒ½è¡¨ç¤ºåŒä¸€é¢—`BST`ï¼Œä»Žå·¦åˆ°å³ä¾æ¬¡ä»£è¡¨äº†ï¼š`LL`ï¼Œ`RR`ï¼Œ`LR`ï¼Œ`RL`ï¼Œè¿™å››ç§æƒ…å†µéƒ½ç­‰ä»·äºŽæœ€ä¸‹é¢ç»¿è‰²æƒ…å†µã€‚

![image-20210413165607875](..\LeetCodeåˆ·é¢˜\images\image-20210413165607875.png)

>   AVLç»´æŒè‡ªå¹³è¡¡

AVLç»´æŒè‡ªå¹³è¡¡å°±æ˜¯è¦å°†ä¸Šé¢çš„å››ç§æƒ…å†µè½¬åŒ–æˆä¸Žä¹‹ç­‰ä»·çš„å¹³è¡¡çš„BSTæ ‘çš„æ ·å­ã€‚

`LL`ä¸ºï¼Œå³æ—‹ï¼š

![image-20210413170011119](..\LeetCodeåˆ·é¢˜\images\image-20210413170011119.png)

```python
def rightRotate(node):
    x = node
    y = node.left
    
    w = y.right # å–ä¸‹å³è¾¹çš„ç»“ç‚¹å…ƒç´ 
    
    y.right = x # æ—‹è½¬
    x.left = w
    
    x.height = max(getHeight(x.left),getHeight(x.right))+1
    y.height = max(getHeight(y.left),getHeight(y.right))+1
    return y
```

`RR`å³æ—‹ï¼š

![image-20210413195423096](images/image-20210413195423096.png)

```python
def leftRotate(node):
    x = node
    y = x.right
    w = y.left
    y.left = x
    x.right = w
    x.height = max(getHeight(x.left),getHeight(x.right))+1
    y.height = max(getHeight(y.left),getHeight(y.right))+1
    return y
```

`LR` 

![image-20210413195423096](images/image-20210413195423096-1632735566431.png)

`RL`

![image-20210413195451245](images/image-20210413195451245-1632735580877.png)



#### [çº¢é»‘æ ‘](https://zh.wikipedia.org/wiki/%E7%BA%A2%E9%BB%91%E6%A0%91)



## å­—å…¸æ ‘

#### 421. æ•°ç»„ä¸­ä¸¤ä¸ªæ•°çš„æœ€å¤§å¼‚æˆ–å€¼

æ€è·¯ï¼šå­—å…¸æ ‘

```python
class Solution:
    def findMaximumXOR(self, nums: List[int]) -> int:
        L = len(bin(max(nums)))-2 # æ±‚å‡ºæ‰€æœ‰æ•°å­—æœ€å¤§çš„é‚£ä¸ªæ•°çš„äºŒè¿›åˆ¶é•¿åº¦
        root = dict()
		
        # å»ºç«‹å­—å…¸æ ‘
        for n in nums:
            node = root
            for i in range(L,-1,-1):
                v = (n >> i) & 1
                if v not in node:
                    node[v] = dict()
                    node = node[v]
                else:
                    node = node[v]
        res = 0
        for n in nums:
            node = root
            total = 0
            for i in range(L,-1,-1): # æ±‚è§£
                v = (n >> i) & 1
                if 1-v in node:
                    total = (total<<1)|1
                    node = node[1-v]
                else:
                    total = total<<1
                    node = node[v]
            res = max(res,total)

        return res
```
