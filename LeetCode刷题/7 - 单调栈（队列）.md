[TOC]

#### 42 æ¥é›¨æ°´

>   â€‹    **å•è°ƒæ ˆï¼ˆæ°´å¹³å¡«å……ï¼‰ï¼š**ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆã€‚
>
>   â€‹    å¦‚æœè¿åäº†å•è°ƒæ€§ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªèŒƒå›´å†…è£…æ°´ï¼Œæ›´æ–°ç»“æœ
>
>   â€‹    å¦åˆ™ï¼Œç»§ç»­ã€‚
>
>   ![image-20210713174102709](images/image-20210713174102709-1626169263773.png)

```python
class Solution:
    def trap(self, height: List[int]) -> int:
        stack = []
        n = len(height)
        fill = 0

        for i in range(n):
            while stack and height[stack[-1]] < height[i]:
                lower = stack.pop()
                if not stack: break
                h = min(height[stack[-1]],height[i]) - height[lower]
                w = i - stack[-1] - 1
                fill += (h*w)
            stack.append(i)
        return fill
```

>   **åŒæŒ‡é’ˆï¼ˆå‚ç›´å¡«å……ï¼‰ï¼š** 
>
>   ç»´æŠ¤å·¦å³æŒ‡é’ˆï¼Œæ ¹æ®çŸ­æ¿åŸç†ï¼Œä¼˜å…ˆä»è¾ƒä½çš„ä½ç½®å¼€å§‹å¡«å……ã€‚
>
>   ![image-20210713173932014](images/image-20210713173932014-1626169173138.png)

```python
class Solution:
    def trap(self, height: List[int]) -> int:
        left,right = 0,len(height)-1

        fill = 0
        while left < right:
            if height[left] >= height[right]:
                if height[right-1] < height[right]:
                    fill += (height[right] - height[right-1])
                    height[right-1] = height[right]
                right -= 1
            else:
                if height[left+1] < height[left]:
                    fill += (height[left] - height[left+1])
                    height[left+1] = height[left]
                left += 1
        return fill
```



#### 84 æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢

>   **å•è°ƒæ ˆï¼š**
>
>   è¿™ä¸€é¢˜å’Œ42é¢˜æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œ42é¢˜æ˜¯è¡¥å…¨ï¼Œè€Œè¿™ä¸€é¢˜æ˜¯ä»ç›´æ–¹å›¾ä¸­æŠ å‡ºæœ€å¤§çŸ©å½¢ã€‚
>
>   â€‹    ç»´æŠ¤å•è°ƒé€’å¢æ ˆã€‚
>
>   â€‹    å¦‚æœä¸‹ä¸€ä¸ªæ•°æ®æ¯”å½“å‰é«˜ï¼Œé‚£ä¹ˆå½“å‰é«˜åº¦ä¸èƒ½ä½œä¸ºç»“æŸæ¡ä»¶ã€‚
>
>   â€‹    å¦‚æœä¸‹ä¸€ä¸ªæ•°æ®æ¯”å½“å‰ä½ï¼Œé‚£ä¹ˆå½“å‰é«˜åº¦çš„æœ€å¤§å€¼å¯ä»¥ç›´æ¥è®¡ç®—ï¼Œä½œä¸ºç»“æŸæ¡ä»¶ã€‚

```python
class Solution:
    def largestRectangleArea(self, heights: List[int]) -> int:
        stack = []
        heights = [0] + heights + [0] # æŠ€å·§ä¸€ï¼šå“¨å…µ
        n = len(heights)
        ans = 0
        for i in range(n):
            while stack and heights[stack[-1]] > heights[i]:
                h = heights[stack.pop()]
                # æŠ€å·§äºŒï¼šç¡®å®šå·¦å³è¾¹ç•Œ
                if not stack: left = 0
                else: left = stack[-1] + 1
                w = i - left
                ans = max(ans,w*h)
            stack.append(i)
        
        return ans

```

>   **æš´åŠ›æ³•ï¼š**
>
>   ä»¥æ¯ä¸€ä¸ªç‚¹å¼€å§‹ï¼Œè¿›è¡Œä¸­å¿ƒæ‰©æ•£ï¼Œæš´åŠ›æ±‚è§£ã€‚



#### 239. æ»‘åŠ¨çª—å£æœ€å¤§å€¼

>   **å•è°ƒé˜Ÿåˆ—ï¼š**
>
>    ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œè¿™æ ·å½“å‰çš„æœ€å¤§å€¼è¢«æ”¾ç½®åœ¨æœ€å·¦è¾¹ï¼Œå› ä¸ºè¦æ±‚æœ€å¤§å€¼ã€‚
>
>   â€‹      \1. å…ˆå°†å‰kä¸ªå…ƒç´ å…¥æ ˆï¼Œç»´æŠ¤å•è°ƒæ€§ã€‚
>
>   â€‹      \2. ç„¶åä¾æ¬¡å°†åé¢çš„æ•°æ®å…¥æ ˆï¼Œå¹¶ç»´æŠ¤å•è°ƒæ€§ã€‚æ ˆçš„åº•éƒ¨ä½œä¸ºæœ€å¤§å€¼ï¼ˆæ‰€ä»¥éœ€è¦åŒå‘é˜Ÿåˆ—ï¼‰
>
>   â€‹      ã€å¦‚æœç»´æŠ¤çš„æ˜¯å•è°ƒé€’å¢æ ˆï¼Œé‚£ä¹ˆå¦‚æœæ–°æ¥çš„å…ƒç´ æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆæ ˆé¡¶çš„å…ƒç´ ï¼ˆå¤§ï¼‰ä¼šè¢«æŠ›å¼ƒã€‘

```python
class Solution:
    def maxSlidingWindow(self, nums: List[int], k: int) -> List[int]:
        """
            ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œå› ä¸ºè¦æ±‚æœ€å¤§å€¼ã€‚
            1. å…ˆå°†å‰kä¸ªå…ƒç´ å…¥æ ˆï¼Œç»´æŠ¤å•è°ƒæ€§ã€‚
            2. ç„¶åä¾æ¬¡å°†åé¢çš„æ•°æ®å…¥æ ˆï¼Œå¹¶ç»´æŠ¤å•è°ƒæ€§ã€‚æ ˆçš„åº•éƒ¨ä½œä¸ºæœ€å¤§å€¼ï¼ˆæ‰€ä»¥éœ€è¦åŒå‘é˜Ÿåˆ—ï¼‰
            ã€å¦‚æœç»´æŠ¤çš„æ˜¯å•è°ƒé€’å¢æ ˆï¼Œé‚£ä¹ˆå¦‚æœæ–°æ¥çš„å…ƒç´ æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆæ ˆé¡¶çš„å…ƒç´ ï¼ˆå¤§ï¼‰ä¼šè¢«æŠ›å¼ƒã€‘
        """
        n = len(nums)
        ans = []

        queue = collections.deque()
        for i in range(k):
            while queue and nums[queue[-1]] < nums[i]:
                queue.pop()
            queue.append(i)
        ans.append(nums[queue[0]])

        for i in range(k,n):
            while queue and nums[queue[-1]] < nums[i]:
                queue.pop()
            queue.append(i)

            while i - queue[0] >= k:
                queue.popleft()
            ans.append(nums[queue[0]])
        
        return ans
```



#### 316 å»é™¤é‡å¤å­—æ¯

>   â€‹    **å­—å…¸åº + å“ˆå¸Œè¡¨ + å•è°ƒæ ˆ:**
>
>   â€‹    å»é™¤é‡å¤å­—æ¯ï¼Œå¹¶ä¿è¯å­—å…¸åºæœ€å°ã€‚
>
>   â€‹    å»é‡æ€ä¹ˆè§£å†³ï¼šåˆ©ç”¨å“ˆå¸Œè¡¨æ¥è§£å†³ã€‚
>
>   â€‹    æ€ä¹ˆä¿è¯å­—å…¸åºæœ€å°ï¼šåˆ©ç”¨å•è°ƒé€’å¢æ ˆæ¥è§£å†³ã€‚
>
>   
>
>   â€‹    å› ä¸ºåé¢æ˜¯å¦è¿˜æœ‰å½“å‰å­—ç¬¦å¯¹äºæœ€ç»ˆç­”æ¡ˆçš„è®¡ç®—ååˆ†é‡è¦ï¼Œæ‰€ä»¥è¿™ä¸€é¢˜
>
>   â€‹    çš„åŸºæœ¬æ€è·¯æ˜¯ï¼š
>
>   â€‹    \1. é¦–å…ˆè®¡ç®—å‡ºæ¯ä¸ªå­—ç¬¦çš„å‡ºç°é¢‘ç‡
>
>   â€‹    \2. ç„¶åéå†å­—ç¬¦ä¸²ï¼š
>
>   â€‹      å¦‚æœå­—ç¬¦å·²ç»åœ¨ç›®æ ‡ä¸²ä¸­ï¼Œåˆ™ç•¥è¿‡å½“å‰å­—ç¬¦ã€‚
>
>   â€‹      å¦‚æœå­—ç¬¦ä¸å†ç›®æ ‡ä¸²ï¼Œåˆ™è¿›è¡Œå•è°ƒæ ˆå¤„ç†ï¼Œä¿è¯å­—å…¸åºã€‚

```python
class Solution:
    def removeDuplicateLetters(self, s: str) -> str:
        s_count = collections.Counter(s)
        n = len(s)
        visited = set()
        stack = []

        for i in range(n):
            val = s[i]
            if val not in visited:
                while stack and s[stack[-1]] > val and s_count[s[stack[-1]]] > 0:
                    visited.discard(s[stack.pop()])
                stack.append(i)
                visited.add(val)
            s_count[val] -= 1
        return "".join([s[i] for i in stack])
```

#### 321. æ‹¼æ¥æœ€å¤§æ•°

>   â€‹    åŸºæœ¬æ€è·¯ï¼šä»num1ä¸­é€‰å–mä¸ªå…ƒç´ ï¼Œä»num2ä¸­é€‰å–nä¸ªå…ƒç´ ï¼Œç„¶åç»„åˆå¾—åˆ°æœ€å¤§çš„é‚£ä¸ªæ•°ã€‚
>
>   â€‹    ğŸš€ åœ¨è¿›è¡Œç»„åˆçš„æ—¶å€™ï¼š
>
>   â€‹      å¦‚æœå½“å‰æ•°æ®æœ‰æ˜ç¡®çš„å¤§å°æ¯”è¾ƒï¼Œåˆ™æŒ‰ç…§è¾ƒå¤§çš„åœ¨å‰ï¼Œè¾ƒå°çš„åœ¨åã€‚
>
>   â€‹      å¦‚æœå½“å‰æ•°æ®ç›¸ç­‰ï¼Œå¯¹äºå­—å…¸åºè€Œè¨€ï¼Œæ¯”è¾ƒæ–¹æ³•åº”è¯¥ä¸ºï¼šæ¯”è¾ƒ s1[i+1:],s2[j+1:]
>
>   â€‹      æ¯”å¦‚ï¼š 1065å’Œ2077ï¼Œåœ¨0ç›¸ç­‰çš„æ—¶å€™ï¼Œåº”è¯¥æ¯”è¾ƒ65å’Œ77ï¼Œä»è€Œç¡®å®šä¸‹ä¸€ä¸ªæ•°å­—ã€‚

```python
class Solution:
    def maxNumber(self, nums1: List[int], nums2: List[int], k: int) -> List[int]:
        """
        åŸºæœ¬æ€è·¯ï¼šä»num1ä¸­é€‰å–mä¸ªå…ƒç´ ï¼Œä»num2ä¸­é€‰å–nä¸ªå…ƒç´ ï¼Œç„¶åç»„åˆå¾—åˆ°æœ€å¤§çš„é‚£ä¸ªæ•°ã€‚
        ğŸš€ åœ¨è¿›è¡Œç»„åˆçš„æ—¶å€™ï¼š
            å¦‚æœå½“å‰æ•°æ®æœ‰æ˜ç¡®çš„å¤§å°æ¯”è¾ƒï¼Œåˆ™æŒ‰ç…§è¾ƒå¤§çš„åœ¨å‰ï¼Œè¾ƒå°çš„åœ¨åã€‚
            å¦‚æœå½“å‰æ•°æ®ç›¸ç­‰ï¼Œå¯¹äºå­—å…¸åºè€Œè¨€ï¼Œæ¯”è¾ƒæ–¹æ³•åº”è¯¥ä¸ºï¼šæ¯”è¾ƒ s1[i+1:],s2[j+1:]
            æ¯”å¦‚ï¼š 1065å’Œ2077ï¼Œåœ¨0ç›¸ç­‰çš„æ—¶å€™ï¼Œåº”è¯¥æ¯”è¾ƒ65å’Œ77ï¼Œä»è€Œç¡®å®šä¸‹ä¸€ä¸ªæ•°å­—ã€‚

        """
        def combine(s1,s2):
            m = len(s1)
            n = len(s2)

            ans = ""
            i = j = 0
            while i < m and j < n:
                if s1[i] > s2[j]:
                    ans += s1[i]
                    i += 1
                elif s1[i] < s2[j]:
                    ans += s2[j]
                    j += 1
                else:
                    # ç›´æ¥å–å¾—åé¢çš„æ•°è¿›è¡Œæ¯”è¾ƒ
                    if s1[i+1:] >= s2[j+1:]:
                        ans += s1[i]
                        i += 1
                    else:
                        ans += s2[j]
                        j += 1
            while i < m:
                ans += s1[i]
                i += 1
            while j < n:
                ans += s2[j]
                j += 1
            return int(ans)
        
        def findK(nums,k):
            """ç»´æŠ¤å•è°ƒé€’å‡æ ˆ"""
            stack = []
            n = len(nums)
            k = n - k
            for i in range(n):
                while stack and nums[stack[-1]] < nums[i] and k > 0:
                    stack.pop()
                    k -= 1
                stack.append(i)
            while k > 0:
                stack.pop()
                k -= 1
            return "".join([str(nums[i]) for i in stack])
        
        ans = max([combine(findK(nums1,i),findK(nums2,k-i)) for i in range(k+1)])
        return list(map(int,list(str(ans))))
```



####  402. ç§»æ‰Kä½æ•°å­—

>   **å­—å…¸åº + å•è°ƒæ ˆ**ï¼š
>
>   â€‹    ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼Œç»“åˆå­—å…¸åºçš„æ¦‚å¿µï¼Œå½“åˆ é™¤çš„æ•°å­—æ•°é‡è¾¾åˆ°kä¹‹åï¼›
>
>   â€‹    åé¢çš„ä¸ç”¨åˆ¤æ–­ç›´æ¥åŠ å…¥
>
>   â€‹    13 < 14
>
>   â€‹    123 < 122

```python
class Solution:
    def removeKdigits(self, num: str, k: int) -> str:
        stack = []
        n = len(num)
        for i in range(n):
            while k > 0 and stack and num[stack[-1]] > num[i]:
                stack.pop()
                k -= 1
            stack.append(i)
        
        # å°†å¤šä½™çš„å…ƒç´ å‰”é™¤
        while k > 0: 
            k -= 1
            stack.pop()
        
        # æ‹¼æ¥æœ€ç»ˆç»“æœ
        ans = "".join([num[index] for index in stack]).lstrip("0")
        return "0" if ans == "" else ans
```



#### 496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I

>   **æš´åŠ›è§£æ³•ï¼š**ï¼Œå…ˆå®šä½å…ƒç´ ï¼Œç„¶åå‘å³è¾¹æœç´¢ã€‚



>   **å•è°ƒæ ˆ + å“ˆå¸Œè¡¨**
>
>   \1. å»ºç«‹ä¸€ä¸ªå­—å…¸ï¼Œå¯¹åº”ï¼š{nums2[i]:ä¸‹ä¸€ä¸ªè¾ƒå¤§å…ƒç´ }
>
>   \2. åŸºäºå•è°ƒæ ˆï¼Œæ±‚å‡ºnums2ä¸­ä¸‹ä¸€ä¸ªè¾ƒå¤§å…ƒç´ ï¼Œå¹¶å­˜æ”¾åˆ°å­—å…¸ä¸­
>
>   \3. å°†å­—å…¸ä¸­çš„æ•°æ®æ˜ å°„åˆ°nums1ç»“æœä¸­

```python
class Solution:
    def nextGreaterElement(self, nums1: List[int], nums2: List[int]) -> List[int]:
        nums2_dict = collections.defaultdict(lambda:-1)
        n = len(nums2)

        stack = []
        for i in range(n):
            while stack and nums2[stack[-1]] < nums2[i]:
                nums2_dict[nums2[stack.pop()]] = nums2[i]
            stack.append(i)
        
        return [nums2_dict[val] for val in nums1]        
```



#### 503. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  II

>   **å•è°ƒæ ˆï¼š**
>
>     ç¬¬ä¸€ä¸ªéš¾ç‚¹æ˜¯ï¼šå•è°ƒæ ˆã€‚
>
>     ç¬¬äºŒä¸ªéš¾ç‚¹æ˜¯ï¼šå¾ªç¯æ•°ç»„ã€‚
>
>     å¯¹äºç¬¬ä¸€ä¸ªï¼Œç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œè®°å½•ä¸‹æ ‡å…ƒç´ ã€‚
>
>     å¯¹äºç¬¬äºŒä¸ªï¼Œå†éå†ä¸€éæ•°ç»„

```python
class Solution:
    def nextGreaterElements(self, nums: List[int]) -> List[int]:
        n = len(nums)
        ans = [-1]*n
        stack = []
        n = len(nums)

        for i in range(n):
            while stack and nums[stack[-1]] < nums[i]:
                ans[stack.pop()] = nums[i]
            stack.append(i)

        for i in range(n):
            while stack and nums[stack[-1]] < nums[i]:
                ans[stack.pop()] = nums[i]
            stack.append(i)
        
        return ans
```

#### 581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„

>   **å•è°ƒæ ˆï¼š**
>
>   â€‹    ç»´æŠ¤ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªæ˜¯å•è°ƒé€’å¢æ ˆï¼Œä¸€ä¸ªæ˜¯å•è°ƒé€’å‡æ ˆ
>
>   â€‹    ä»å·¦åˆ°å³ï¼Œå•è°ƒé€’å¢æ ˆ
>
>   â€‹    ä»å³åˆ°å·¦ï¼Œå•è°ƒé€’å‡æ ˆ

```python
class Solution:
    def findUnsortedSubarray(self, nums: List[int]) -> int:
        """
        ç»´æŠ¤ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªæ˜¯å•è°ƒé€’å¢æ ˆï¼Œä¸€ä¸ªæ˜¯å•è°ƒé€’å‡æ ˆ
        ä»å·¦åˆ°å³ï¼Œå•è°ƒé€’å¢æ ˆ
        ä»å³åˆ°å·¦ï¼Œå•è°ƒé€’å‡æ ˆ
        """
        n = len(nums)
        left,right = n-1,0
        
        # å•è°ƒé€’å¢æ ˆ
        stack = []
        for i in range(n):
            while stack and nums[stack[-1]] > nums[i]:
                left = min(left,stack.pop())
            stack.append(i)
        if left == n-1: return 0

        # å•è°ƒé€’å‡æ ˆ
        stack = []
        for i in range(n-1,-1,-1):
            while stack and nums[stack[-1]] < nums[i]:
                right = max(right,stack.pop())
            stack.append(i)
        
        return right-left+1


```



#### 739 æ¯æ—¥æ¸©åº¦

>   **å•è°ƒæ ˆï¼š**
>
>   ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œå¦‚æœæ•°æ®å˜å¾—æ›´å¤§ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºå¯¹åº”çš„ç»“æœã€‚
>
>   **æ•°æ®ä¸¥æ ¼é€’å‡**

```python
class Solution:
    def dailyTemperatures(self, temperatures: List[int]) -> List[int]:
        """
        ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œå¦‚æœæ•°æ®å˜å¾—æ›´å¤§ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºå¯¹åº”çš„ç»“æœã€‚
        """
        stack = []
        n = len(temperatures)
        ans = [0]*n

        for i in range(n):
            while stack and temperatures[stack[-1]] < temperatures[i]: # æŒ‰ç…§ä¸¥æ ¼é€’å‡çš„å†™æ³•
                ans[stack.pop()] = i - stack[-1]
            stack.append(i)
        return ans
```







#### 907. å­æ•°ç»„çš„æœ€å°å€¼ä¹‹å’Œ

>   **å•è°ƒæ ˆï¼š**ç»´æŠ¤ä¸€ä¸ª`å•è°ƒé€’å¢æ ˆ`ï¼Œæ ˆé¡¶çš„å…ƒç´ æ˜¯å½“å‰çš„æœ€å¤§å…ƒç´ ã€‚
>
>   ![stackl-1Jl's sInallest.png](images/1613007377-MVxZMC-stackl-1Jl's sInallest.png)

```python
class Solution:
    def sumSubarrayMins(self, arr: List[int]) -> int:
        """
        å•è°ƒé€’å¢æ ˆï¼Œæ ˆé¡¶çš„å…ƒç´ æ˜¯å½“å‰çš„æœ€å¤§å…ƒç´ 
        """
        stack = []
        arr = arr + [0]
        n = len(arr)
        ans = 0
        MAX_VAL = 1000000007

        for i in range(n):
            while stack and arr[stack[-1]] > arr[i]:
                index = stack.pop()
                if not stack: left = 0
                else: left = stack[-1] + 1

                # i-index-1è®°å½•çš„æ˜¯å·¦è¾¹çš„æ•°æ®
                # 1 è¡¨ç¤ºå½“å‰æ•°æ®
                # index-leftè®°å½•çš„æ˜¯å³è¾¹çš„æ•°æ®
                # (index-left)*(i-index-1) è®°å½•çš„æ˜¯è·¨å·¦å³çš„æ•°æ®
                ans = (ans + ((i-index-1) + 1 + (index-left) + (index-left)*(i-index-1)) * arr[index]) % MAX_VAL
            stack.append(i)
        
        return ans
```



#### 1793. å¥½å­æ•°ç»„çš„æœ€å¤§åˆ†æ•°

>   **å•è°ƒæ ˆï¼š**
>
>   ![stackl-1Jl's sInallest.png](images/1613007377-MVxZMC-stackl-1Jl's sInallest-1626233340791.png)
>
>   â€‹    ç±»ä¼¼äºæœ€å¤§çŸ©å½¢é¢ç§¯ï¼Œåªä¸è¿‡æœ‰äº†k
>
>   â€‹    ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼š
>
>   â€‹      å¦‚æœæ•°æ®å˜å°äº†ï¼Œé‚£ä¹ˆä»¥å½“å‰æ•°æ®ä¸ºæœ€ä½ç‚¹çš„æœ€å¤§åˆ†æ•°å°±å¯ä»¥å¾—åˆ°ã€‚
>
>   â€‹      å¦‚æœæ•°æ®å˜å¤§äº†ï¼Œé‚£ä¹ˆä¸€å½“å‰æ•°æ®æœ€ä¸ºæœ€ä½ç‚¹çš„æœ€å¤§åˆ†æ•°è¿˜å¯ä»¥æ›´æ–°ã€‚
>
>   â€‹    æœ‰äº†kä¹‹ååšä¸€ä¸ªåˆ¤æ–­ï¼Œæ’é™¤æ‰å“ªäº›ä¸å¯èƒ½çš„ç»“æœ

```python
class Solution:
    def maximumScore(self, nums: List[int], k: int) -> int:
        """
        ç±»ä¼¼äºæœ€å¤§çŸ©å½¢é¢ç§¯ï¼Œåªä¸è¿‡æœ‰äº†k
        ç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢æ ˆï¼š
            å¦‚æœæ•°æ®å˜å°äº†ï¼Œé‚£ä¹ˆä»¥å½“å‰æ•°æ®ä¸ºæœ€ä½ç‚¹çš„æœ€å¤§åˆ†æ•°å°±å¯ä»¥å¾—åˆ°ã€‚
            å¦‚æœæ•°æ®å˜å¤§äº†ï¼Œé‚£ä¹ˆä¸€å½“å‰æ•°æ®æœ€ä¸ºæœ€ä½ç‚¹çš„æœ€å¤§åˆ†æ•°è¿˜å¯ä»¥æ›´æ–°ã€‚
        æœ‰äº†kä¹‹ååšä¸€ä¸ªåˆ¤æ–­ï¼Œæ’é™¤æ‰å“ªäº›ä¸å¯èƒ½çš„ç»“æœ
        """
        stack = []
        nums = [0] + nums + [0]
        n = len(nums)

        ans = 0
        for i in range(n):
            while stack and nums[stack[-1]] > nums[i]:
                height = nums[stack.pop()]
                if not stack: left = 0
                else: left = stack[-1] + 1
                width = i - left
                if left <= k+1 <= i-1: # æ’é™¤æ‰å…¶ä»–å¯èƒ½
                    ans = max(ans,height*width)
            stack.append(i)
        return ans

```

#### å­—èŠ‚å•†ä¸šåŒ–å˜ç°  é¢˜ç›®

>   **åŒºé—´æœ€å°æ•°ä¹˜åŒºé—´å’Œçš„æœ€å¤§å€¼**
>
>   ä½œè€…ï¼šä¸€ä¸ªæ¬ç –çš„èƒ–å­
>   é“¾æ¥ï¼šhttps://www.nowcoder.com/discuss/599813?type=post&order=time&pos=&page=1&ncTraceId=&channel=-1&source_id=search_post_nctrack&subType=2
>   æ¥æºï¼šç‰›å®¢ç½‘
>
>   ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œè¦æ±‚é€‰å‡ºä¸€ä¸ªåŒºé—´, ä½¿å¾—è¯¥åŒºé—´æ˜¯æ‰€æœ‰åŒºé—´ä¸­ç»è¿‡å¦‚ä¸‹è®¡ç®—çš„å€¼æœ€å¤§çš„ä¸€ä¸ªï¼šåŒºé—´ä¸­çš„æœ€å°æ•° * åŒºé—´æ‰€æœ‰æ•°çš„å’Œã€‚æ•°ç»„ä¸­çš„å…ƒç´ éƒ½æ˜¯éè´Ÿæ•°ã€‚è¾“å…¥ä¸¤è¡Œï¼Œç¬¬ä¸€è¡Œnè¡¨ç¤ºæ•°ç»„é•¿åº¦ï¼Œç¬¬äºŒè¡Œä¸ºæ•°ç»„åºåˆ—ã€‚è¾“å‡ºæœ€å¤§å€¼
>
>   >   è¾“å…¥
>   >   3
>   >   6 2 1
>   >   è¾“å‡º
>   >   36
>   >   è§£é‡Šï¼šæ»¡è¶³æ¡ä»¶åŒºé—´æ˜¯[6] = 6 * 6 = 36;

```python
class Solution:
    def solve(self,nums):
        stack = []
        nums = [0] + nums + [0]
        n = len(nums)
        ans = 0

        prefix_sum = [0] * n
        for i in range(1,n):
            # å‰ç¼€å’Œä¸åŒ…å«å½“å‰å…ƒç´ 
            prefix_sum[i] = prefix_sum[i-1] + nums[i-1]
        
        for i in range(n):
            while stack and nums[stack[-1]] > nums[i]:
                height = nums[stack.pop()]
                
                if not stack: left = 0
                else: left = stack[-1] + 1

                ans = max(ans,height*(prefix_sum[i]-prefix_sum[left]))
            stack.append(i)
        return ans
```



#### å•è°ƒæ ˆæ¡†æ¶

>   å•è°ƒé€’å‡æ ˆï¼Œæ— å“¨å…µ
>
>   **42 æ¥é›¨æ°´**

```python
stack = []
fill = 0
for i in range(len(height)):
    while stack and height[i] > height[stack[-1]]:
        h = heights[stack.pop()]
        if not stack:  break
        fill += (min(height[stack[-1]],height[i]) - h) * (i - stack[-1] - 1)
    stack.append(i)
return fill
```

>   å•è°ƒé€’å¢æ ˆï¼Œæœ‰å“¨å…µ
>
>   **84 æœ€å¤§çŸ©å½¢é¢ç§¯**

```python
heights.append(0)
stack = [-1]
ans = 0 
for i in range(len(heights)):
    while heights[i] < heights[stack[-1]]:
        h = heights[stack.pop()]
        w = i - stack[-1] - 1
        ans = max(ans, h * w)
    stack.append(i)
return ans
```







#### é¢˜é›†

[@liweiwe](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/solution/bao-li-jie-fa-zhan-by-liweiwei1419/)

| åºå· |                             é¢˜ç›®                             |                             é¢˜è§£                             |
| :--: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|  1   | [42. æ¥é›¨æ°´ï¼ˆå›°éš¾ï¼‰](https://leetcode-cn.com/problems/trapping-rain-water/) | [æš´åŠ›è§£æ³•ã€ä¼˜åŒ–ã€åŒæŒ‡é’ˆã€å•è°ƒæ ˆ](https://leetcode-cn.com/problems/trapping-rain-water/solution/bao-li-jie-fa-yi-kong-jian-huan-shi-jian-zhi-zhen-/) |
|  2   | [84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/) | [æš´åŠ›è§£æ³•ã€æ ˆï¼ˆå•è°ƒæ ˆã€å“¨å…µæŠ€å·§ï¼‰](https://leetcode-cn.com/problems/largest-rectangle-in-histogram/solution/bao-li-jie-fa-zhan-by-liweiwei1419/) |
|  2   | [739. æ¯æ—¥æ¸©åº¦ï¼ˆä¸­ç­‰ï¼‰](https://leetcode-cn.com/problems/daily-temperatures/) | [æš´åŠ›è§£æ³• + å•è°ƒæ ˆ](https://leetcode-cn.com/problems/daily-temperatures/solution/bao-li-jie-fa-dan-diao-zhan-by-liweiwei1419/) |
|  3   | [496. ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  Iï¼ˆç®€å•ï¼‰](https://leetcode-cn.com/problems/next-greater-element-i/) | [æš´åŠ›è§£æ³•ã€å•è°ƒæ ˆ](https://leetcode-cn.com/problems/next-greater-element-i/solution/bao-li-jie-fa-dan-diao-zhan-by-liweiwei1419-2/) |
|  4   | [ 402. ç§»æ‰Kä½æ•°å­—](https://leetcode-cn.com/problems/remove-k-digits/) |                                                              |
|  5   | [581. æœ€çŸ­æ— åºè¿ç»­å­æ•°ç»„](https://leetcode-cn.com/problems/shortest-unsorted-continuous-subarray/) |                                                              |
|      |                                                              |                                                              |

[316. å»é™¤é‡å¤å­—æ¯](https://leetcode-cn.com/problems/remove-duplicate-letters/) (å›°éš¾)|[321. æ‹¼æ¥æœ€å¤§æ•°](https://leetcode-cn.com/problems/create-maximum-number/) (å›°éš¾)|[402. ç§»æ‰ K ä½æ•°å­—](https://leetcode-cn.com/problems/remove-k-digits/) (ä¸­ç­‰)|[1081. ä¸åŒå­—ç¬¦çš„æœ€å°å­åºåˆ—](https://leetcode-cn.com/problems/smallest-subsequence-of-distinct-characters/) ï¼ˆä¸­ç­‰ï¼ŒåŒ316é¢˜ï¼‰

